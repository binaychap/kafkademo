[2018-01-12 15:08:22,374] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2018-01-12 15:08:22,375] DEBUG [Controller id=0] De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:08:22,377] DEBUG [Controller id=0] De-registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:08:22,378] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-01-12 15:08:22,379] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:08:22,382] INFO [Controller-0-to-broker-0-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-01-12 15:08:22,382] INFO [Controller-0-to-broker-0-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-01-12 15:08:22,382] INFO [Controller-0-to-broker-0-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-01-12 15:08:22,386] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2018-01-12 15:08:22,388] INFO [Controller id=0] 0 successfully elected as the controller (kafka.controller.KafkaController)
[2018-01-12 15:08:22,388] INFO [Controller id=0] Starting become controller state transition (kafka.controller.KafkaController)
[2018-01-12 15:08:22,391] INFO [Controller id=0] Initialized controller epoch to 1 and zk version 0 (kafka.controller.KafkaController)
[2018-01-12 15:08:22,393] INFO [Controller id=0] Incremented epoch to 2 (kafka.controller.KafkaController)
[2018-01-12 15:08:22,395] DEBUG [Controller id=0] Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:08:22,399] DEBUG [Controller id=0] Registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:08:22,402] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:08:22,405] INFO [Controller-0-to-broker-0-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:08:22,405] INFO [Controller id=0] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-01-12 15:08:22,405] INFO [Controller id=0] Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2018-01-12 15:08:22,405] INFO [Controller id=0] Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-01-12 15:08:22,405] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2018-01-12 15:08:22,405] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-01-12 15:08:22,405] INFO [Controller id=0] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2018-01-12 15:08:22,406] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-01-12 15:08:22,406] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2018-01-12 15:08:22,406] INFO [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map() (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:08:22,407] INFO [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map() (kafka.controller.PartitionStateMachine)
[2018-01-12 15:08:22,407] INFO [Controller id=0] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2018-01-12 15:08:22,407] INFO [Controller-0-to-broker-0-send-thread]: Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:08:22,408] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-01-12 15:08:22,408] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-01-12 15:08:22,408] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2018-01-12 15:08:22,408] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-01-12 15:08:22,408] INFO [Controller id=0] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-01-12 15:08:22,408] INFO [PartitionStateMachine controllerId=0] Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-01-12 15:08:22,410] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2018-01-12 15:08:22,414] INFO [Controller id=0] Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2018-01-12 15:08:22,415] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2018-01-12 15:08:22,416] INFO [Controller id=0] New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.KafkaController)
[2018-01-12 15:08:27,415] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:08:27,415] DEBUG [Controller id=0] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2018-01-12 15:13:27,423] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:13:27,424] DEBUG [Controller id=0] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2018-01-12 15:18:27,431] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:18:27,431] DEBUG [Controller id=0] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2018-01-12 15:23:27,439] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:23:27,440] DEBUG [Controller id=0] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2018-01-12 15:28:27,443] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:28:27,444] DEBUG [Controller id=0] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2018-01-12 15:32:54,699] INFO [controller-event-thread]: Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:32:54,706] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2018-01-12 15:32:54,830] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2018-01-12 15:32:54,831] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:32:54,833] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2018-01-12 15:32:54,833] INFO [Controller-0-to-broker-1-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:32:54,835] INFO [Controller-0-to-broker-0-send-thread]: Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:32:54,835] INFO [Controller-0-to-broker-1-send-thread]: Controller 0 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:33:27,448] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:33:27,448] DEBUG [Controller id=0] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2018-01-12 15:37:42,784] INFO [controller-event-thread]: Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:37:42,792] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2018-01-12 15:37:42,916] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2018-01-12 15:37:42,916] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:37:42,918] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2018-01-12 15:37:42,918] INFO [Controller-0-to-broker-2-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:37:42,920] INFO [Controller-0-to-broker-2-send-thread]: Controller 0 connected to localhost:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:38:17,712] INFO [controller-event-thread]: Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:38:17,722] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2018-01-12 15:38:17,844] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , all live brokers: 0,1,2,4 (kafka.controller.KafkaController)
[2018-01-12 15:38:17,844] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:38:17,846] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2018-01-12 15:38:17,847] INFO [Controller-0-to-broker-4-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:38:17,850] INFO [Controller-0-to-broker-4-send-thread]: Controller 0 connected to localhost:9095 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:38:27,452] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:38:27,452] DEBUG [Controller id=0] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2018-01-12 15:40:27,906] INFO [Controller id=0] New topics: [Set(localdev.connect.grade.create)], deleted topics: [Set()], new partition replica assignment [Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4))] (kafka.controller.KafkaController)
[2018-01-12 15:40:27,907] INFO [Controller id=0] New topic creation callback for localdev.connect.grade.create-1,localdev.connect.grade.create-0 (kafka.controller.KafkaController)
[2018-01-12 15:40:27,910] INFO [Controller id=0] New partition creation callback for localdev.connect.grade.create-1,localdev.connect.grade.create-0 (kafka.controller.KafkaController)
[2018-01-12 15:40:27,910] INFO [PartitionStateMachine controllerId=0] Invoking state change to NewPartition for partitions localdev.connect.grade.create-1,localdev.connect.grade.create-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:27,919] INFO [ReplicaStateMachine controllerId=0] Invoking state change to NewReplica for replicas [Topic=localdev.connect.grade.create,Partition=0,Replica=1],[Topic=localdev.connect.grade.create,Partition=1,Replica=1],[Topic=localdev.connect.grade.create,Partition=0,Replica=2],[Topic=localdev.connect.grade.create,Partition=1,Replica=2],[Topic=localdev.connect.grade.create,Partition=0,Replica=0],[Topic=localdev.connect.grade.create,Partition=1,Replica=4],[Topic=localdev.connect.grade.create,Partition=0,Replica=4],[Topic=localdev.connect.grade.create,Partition=1,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:40:27,929] INFO [PartitionStateMachine controllerId=0] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-1,localdev.connect.grade.create-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:27,932] DEBUG [PartitionStateMachine controllerId=0] Live assigned replicas for partition localdev.connect.grade.create-1 are: [List(2, 1, 4, 0)] (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:27,934] DEBUG [PartitionStateMachine controllerId=0] Initializing leader and isr for partition localdev.connect.grade.create-1 to (Leader:2,ISR:2,1,4,0,LeaderEpoch:0,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:27,948] DEBUG [PartitionStateMachine controllerId=0] Live assigned replicas for partition localdev.connect.grade.create-0 are: [List(1, 0, 2, 4)] (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:27,948] DEBUG [PartitionStateMachine controllerId=0] Initializing leader and isr for partition localdev.connect.grade.create-0 to (Leader:1,ISR:1,0,2,4,LeaderEpoch:0,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:27,963] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.grade.create,Partition=0,Replica=1],[Topic=localdev.connect.grade.create,Partition=1,Replica=1],[Topic=localdev.connect.grade.create,Partition=0,Replica=2],[Topic=localdev.connect.grade.create,Partition=1,Replica=2],[Topic=localdev.connect.grade.create,Partition=0,Replica=0],[Topic=localdev.connect.grade.create,Partition=1,Replica=4],[Topic=localdev.connect.grade.create,Partition=0,Replica=4],[Topic=localdev.connect.grade.create,Partition=1,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:40:27,974] INFO [Controller id=0] New topics: [Set(localdev.connect.assignment.update)], deleted topics: [Set()], new partition replica assignment [Map(localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1))] (kafka.controller.KafkaController)
[2018-01-12 15:40:27,974] INFO [Controller id=0] New topic creation callback for localdev.connect.assignment.update-0 (kafka.controller.KafkaController)
[2018-01-12 15:40:27,975] INFO [Controller id=0] New partition creation callback for localdev.connect.assignment.update-0 (kafka.controller.KafkaController)
[2018-01-12 15:40:27,975] INFO [PartitionStateMachine controllerId=0] Invoking state change to NewPartition for partitions localdev.connect.assignment.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:27,976] INFO [ReplicaStateMachine controllerId=0] Invoking state change to NewReplica for replicas [Topic=localdev.connect.assignment.update,Partition=0,Replica=2],[Topic=localdev.connect.assignment.update,Partition=0,Replica=4],[Topic=localdev.connect.assignment.update,Partition=0,Replica=0],[Topic=localdev.connect.assignment.update,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:40:27,989] INFO [PartitionStateMachine controllerId=0] Invoking state change to OnlinePartition for partitions localdev.connect.assignment.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:27,989] DEBUG [PartitionStateMachine controllerId=0] Live assigned replicas for partition localdev.connect.assignment.update-0 are: [List(2, 4, 0, 1)] (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:27,989] DEBUG [PartitionStateMachine controllerId=0] Initializing leader and isr for partition localdev.connect.assignment.update-0 to (Leader:2,ISR:2,4,0,1,LeaderEpoch:0,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:28,000] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.assignment.update,Partition=0,Replica=2],[Topic=localdev.connect.assignment.update,Partition=0,Replica=4],[Topic=localdev.connect.assignment.update,Partition=0,Replica=0],[Topic=localdev.connect.assignment.update,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:40:28,003] INFO [Controller id=0] New topics: [Set(localdev.connect.section.update)], deleted topics: [Set()], new partition replica assignment [Map(localdev.connect.section.update-0 -> Vector(4, 2, 0, 1))] (kafka.controller.KafkaController)
[2018-01-12 15:40:28,003] INFO [Controller id=0] New topic creation callback for localdev.connect.section.update-0 (kafka.controller.KafkaController)
[2018-01-12 15:40:28,004] INFO [Controller id=0] New partition creation callback for localdev.connect.section.update-0 (kafka.controller.KafkaController)
[2018-01-12 15:40:28,004] INFO [PartitionStateMachine controllerId=0] Invoking state change to NewPartition for partitions localdev.connect.section.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:28,005] INFO [ReplicaStateMachine controllerId=0] Invoking state change to NewReplica for replicas [Topic=localdev.connect.section.update,Partition=0,Replica=4],[Topic=localdev.connect.section.update,Partition=0,Replica=2],[Topic=localdev.connect.section.update,Partition=0,Replica=0],[Topic=localdev.connect.section.update,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:40:28,009] INFO [PartitionStateMachine controllerId=0] Invoking state change to OnlinePartition for partitions localdev.connect.section.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:28,009] DEBUG [PartitionStateMachine controllerId=0] Live assigned replicas for partition localdev.connect.section.update-0 are: [List(4, 2, 0, 1)] (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:28,009] DEBUG [PartitionStateMachine controllerId=0] Initializing leader and isr for partition localdev.connect.section.update-0 to (Leader:4,ISR:4,2,0,1,LeaderEpoch:0,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:40:28,019] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.section.update,Partition=0,Replica=4],[Topic=localdev.connect.section.update,Partition=0,Replica=2],[Topic=localdev.connect.section.update,Partition=0,Replica=0],[Topic=localdev.connect.section.update,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:43:27,587] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:43:27,594] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1)), 4 -> Map(localdev.connect.section.update-0 -> Vector(4, 2, 0, 1)), 1 -> Map(localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4))) (kafka.controller.KafkaController)
[2018-01-12 15:43:27,596] DEBUG [Controller id=0] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:43:27,597] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:43:27,597] DEBUG [Controller id=0] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:43:27,597] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:43:27,597] DEBUG [Controller id=0] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:43:27,597] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:48:27,601] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:48:27,602] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1)), 4 -> Map(localdev.connect.section.update-0 -> Vector(4, 2, 0, 1)), 1 -> Map(localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4))) (kafka.controller.KafkaController)
[2018-01-12 15:48:27,602] DEBUG [Controller id=0] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:48:27,602] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:48:27,602] DEBUG [Controller id=0] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:48:27,602] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:48:27,602] DEBUG [Controller id=0] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:48:27,602] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:52:46,540] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2018-01-12 15:52:46,540] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2018-01-12 15:52:46,541] DEBUG [Controller id=0] Live brokers: 1,2,4 (kafka.controller.KafkaController)
[2018-01-12 15:52:46,552] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,552] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=localdev.connect.grade.create,Partition=1,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,554] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OfflineReplica for replicas [Topic=localdev.connect.grade.create,Partition=1,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:52:46,554] INFO [Controller-0-to-broker-0-send-thread]: Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:52:46,555] DEBUG [Controller id=0] Removing replica 0 from ISR 2,1,4,0 for partition localdev.connect.grade.create-1. (kafka.controller.KafkaController)
[2018-01-12 15:52:46,561] INFO [Controller id=0] New leader and ISR for partition localdev.connect.grade.create-1 is {"leader":2,"leader_epoch":1,"isr":[2,1,4]} (kafka.controller.KafkaController)
[2018-01-12 15:52:46,562] INFO [Controller-0-to-broker-4-send-thread]: Controller 0 connected to localhost:9095 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:52:46,563] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,563] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=localdev.connect.grade.create,Partition=1,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,563] INFO [Controller-0-to-broker-2-send-thread]: Controller 0 connected to localhost:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:52:46,563] INFO [Controller-0-to-broker-1-send-thread]: Controller 0 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:52:46,563] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,563] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=localdev.connect.grade.create,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,564] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OfflineReplica for replicas [Topic=localdev.connect.grade.create,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:52:46,564] DEBUG [Controller id=0] Removing replica 0 from ISR 1,0,2,4 for partition localdev.connect.grade.create-0. (kafka.controller.KafkaController)
[2018-01-12 15:52:46,577] INFO [Controller id=0] New leader and ISR for partition localdev.connect.grade.create-0 is {"leader":1,"leader_epoch":1,"isr":[1,2,4]} (kafka.controller.KafkaController)
[2018-01-12 15:52:46,579] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,579] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=localdev.connect.grade.create,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,579] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,579] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=localdev.connect.assignment.update,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,580] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OfflineReplica for replicas [Topic=localdev.connect.assignment.update,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:52:46,580] DEBUG [Controller id=0] Removing replica 0 from ISR 2,4,0,1 for partition localdev.connect.assignment.update-0. (kafka.controller.KafkaController)
[2018-01-12 15:52:46,587] INFO [Controller id=0] New leader and ISR for partition localdev.connect.assignment.update-0 is {"leader":2,"leader_epoch":1,"isr":[2,4,1]} (kafka.controller.KafkaController)
[2018-01-12 15:52:46,588] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,588] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=localdev.connect.assignment.update,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,589] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,589] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=localdev.connect.section.update,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,589] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OfflineReplica for replicas [Topic=localdev.connect.section.update,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:52:46,589] DEBUG [Controller id=0] Removing replica 0 from ISR 4,2,0,1 for partition localdev.connect.section.update-0. (kafka.controller.KafkaController)
[2018-01-12 15:52:46,599] INFO [Controller id=0] New leader and ISR for partition localdev.connect.section.update-0 is {"leader":4,"leader_epoch":1,"isr":[4,2,1]} (kafka.controller.KafkaController)
[2018-01-12 15:52:46,606] DEBUG The stop replica request (delete = true) sent to broker 0 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,606] DEBUG The stop replica request (delete = false) sent to broker 0 is [Topic=localdev.connect.section.update,Partition=0,Replica=0] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:52:46,607] TRACE [Controller id=0] All leaders = localdev.connect.grade.create-1 -> (Leader:2,ISR:2,1,4,LeaderEpoch:1,ControllerEpoch:2),localdev.connect.grade.create-0 -> (Leader:1,ISR:1,2,4,LeaderEpoch:1,ControllerEpoch:2),localdev.connect.assignment.update-0 -> (Leader:2,ISR:2,4,1,LeaderEpoch:1,ControllerEpoch:2),localdev.connect.section.update-0 -> (Leader:4,ISR:4,2,1,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2018-01-12 15:52:46,626] WARN [Controller-0-to-broker-0-send-thread]: Controller 0 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=2, deletePartitions=false, partitions=localdev.connect.assignment.update-0) to broker localhost:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:95)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:230)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:46,732] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:46,833] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:46,937] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,041] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,144] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,249] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,353] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,458] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,561] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,665] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,766] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,827] DEBUG [Controller id=0] Sending MetadataRequest to Brokers:Vector(0, 1, 2, 4) for TopicAndPartitions:Set(localdev.connect.section.update-0) (kafka.controller.KafkaController)
[2018-01-12 15:52:47,869] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:47,971] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:48,075] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:48,180] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:48,281] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:48,382] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:48,484] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:48,590] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:48,693] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:48,797] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:48,903] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,009] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,114] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,218] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,323] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,427] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,531] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,635] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,737] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,838] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:49,940] WARN [Controller-0-to-broker-0-send-thread]: Controller 0's connection to broker localhost:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:52:50,034] INFO [controller-event-thread]: Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:52:50,034] INFO [controller-event-thread]: Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:52:50,034] INFO [controller-event-thread]: Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:52:50,034] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2018-01-12 15:52:50,034] DEBUG [Controller id=0] De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:52:50,035] DEBUG [Controller id=0] De-registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:52:50,035] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-01-12 15:52:50,035] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:52:50,035] INFO [Controller-0-to-broker-2-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,035] INFO [Controller-0-to-broker-2-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,035] INFO [Controller-0-to-broker-2-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,037] INFO [Controller-0-to-broker-4-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,037] INFO [Controller-0-to-broker-4-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,037] INFO [Controller-0-to-broker-4-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,039] INFO [Controller-0-to-broker-1-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,039] INFO [Controller-0-to-broker-1-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,039] INFO [Controller-0-to-broker-1-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,040] INFO [Controller-0-to-broker-0-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,040] INFO [Controller-0-to-broker-0-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,040] INFO [Controller-0-to-broker-0-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,042] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2018-01-12 15:52:50,053] INFO [Controller id=2] 2 successfully elected as the controller (kafka.controller.KafkaController)
[2018-01-12 15:52:50,053] INFO [Controller id=2] Starting become controller state transition (kafka.controller.KafkaController)
[2018-01-12 15:52:50,055] DEBUG [Controller id=1] Broker 2 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
[2018-01-12 15:52:50,055] DEBUG [Controller id=4] Broker 2 was elected as controller instead of broker 4 (kafka.controller.KafkaController)
[2018-01-12 15:52:50,057] INFO [Controller id=2] Initialized controller epoch to 2 and zk version 1 (kafka.controller.KafkaController)
[2018-01-12 15:52:50,059] INFO [Controller id=2] Incremented epoch to 3 (kafka.controller.KafkaController)
[2018-01-12 15:52:50,063] DEBUG [Controller id=2] Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:52:50,071] DEBUG [Controller id=2] Registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:52:50,105] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:52:50,109] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:52:50,110] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:52:50,113] INFO [Controller-2-to-broker-1-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,113] INFO [Controller-2-to-broker-2-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,113] INFO [Controller-2-to-broker-4-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,115] INFO [Controller id=2] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-01-12 15:52:50,115] INFO [Controller id=2] Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2018-01-12 15:52:50,115] INFO [Controller id=2] Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-01-12 15:52:50,116] INFO [Controller id=2] Currently active brokers in the cluster: Set(1, 2, 4) (kafka.controller.KafkaController)
[2018-01-12 15:52:50,116] INFO [Controller id=2] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-01-12 15:52:50,116] INFO [Controller id=2] Current list of topics in the cluster: Set(localdev.connect.grade.create, localdev.connect.section.update, localdev.connect.assignment.update) (kafka.controller.KafkaController)
[2018-01-12 15:52:50,121] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-01-12 15:52:50,121] INFO [Controller id=2] List of topics ineligible for deletion: localdev.connect.grade.create,localdev.connect.assignment.update,localdev.connect.section.update (kafka.controller.KafkaController)
[2018-01-12 15:52:50,133] INFO [Controller-2-to-broker-1-send-thread]: Controller 2 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,133] INFO [Controller-2-to-broker-2-send-thread]: Controller 2 connected to localhost:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,133] INFO [Controller-2-to-broker-4-send-thread]: Controller 2 connected to localhost:9095 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:52:50,150] INFO [ReplicaStateMachine controllerId=2] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.section.update,Partition=0,Replica=4],[Topic=localdev.connect.grade.create,Partition=0,Replica=1],[Topic=localdev.connect.grade.create,Partition=1,Replica=1],[Topic=localdev.connect.assignment.update,Partition=0,Replica=1],[Topic=localdev.connect.grade.create,Partition=0,Replica=2],[Topic=localdev.connect.grade.create,Partition=1,Replica=2],[Topic=localdev.connect.assignment.update,Partition=0,Replica=4],[Topic=localdev.connect.section.update,Partition=0,Replica=1],[Topic=localdev.connect.grade.create,Partition=1,Replica=4],[Topic=localdev.connect.grade.create,Partition=0,Replica=4],[Topic=localdev.connect.section.update,Partition=0,Replica=2],[Topic=localdev.connect.assignment.update,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:52:50,162] INFO [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> Map([Topic=localdev.connect.assignment.update,Partition=0,Replica=4] -> OnlineReplica, [Topic=localdev.connect.section.update,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.section.update,Partition=0,Replica=2] -> OnlineReplica, [Topic=localdev.connect.assignment.update,Partition=0,Replica=2] -> OnlineReplica, [Topic=localdev.connect.assignment.update,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=2] -> OnlineReplica, [Topic=localdev.connect.section.update,Partition=0,Replica=1] -> OnlineReplica, [Topic=localdev.connect.assignment.update,Partition=0,Replica=1] -> OnlineReplica, [Topic=localdev.connect.grade.create,Partition=1,Replica=4] -> OnlineReplica, [Topic=localdev.connect.grade.create,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=2] -> OnlineReplica, [Topic=localdev.connect.grade.create,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=1] -> OnlineReplica, [Topic=localdev.connect.grade.create,Partition=1,Replica=1] -> OnlineReplica, [Topic=localdev.connect.grade.create,Partition=0,Replica=4] -> OnlineReplica, [Topic=localdev.connect.section.update,Partition=0,Replica=4] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:52:50,171] INFO [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> Map(localdev.connect.grade.create-1 -> OnlinePartition, localdev.connect.grade.create-0 -> OnlinePartition, localdev.connect.assignment.update-0 -> OnlinePartition, localdev.connect.section.update-0 -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:52:50,173] INFO [Controller id=2] Ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2018-01-12 15:52:50,175] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-01-12 15:52:50,176] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-01-12 15:52:50,176] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2018-01-12 15:52:50,176] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-01-12 15:52:50,176] INFO [Controller id=2] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-01-12 15:52:50,177] INFO [PartitionStateMachine controllerId=2] Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-01-12 15:52:50,186] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2018-01-12 15:52:55,193] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:52:55,195] DEBUG [Controller id=2] Preferred replicas by broker Map(2 -> Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1)), 4 -> Map(localdev.connect.section.update-0 -> Vector(4, 2, 0, 1)), 1 -> Map(localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4))) (kafka.controller.KafkaController)
[2018-01-12 15:52:55,196] DEBUG [Controller id=2] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:52:55,197] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:52:55,197] DEBUG [Controller id=2] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:52:55,197] TRACE [Controller id=2] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:52:55,197] DEBUG [Controller id=2] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:52:55,197] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:53:04,771] INFO [Controller id=2] Shutting down broker 1 (kafka.controller.KafkaController)
[2018-01-12 15:53:04,771] DEBUG [Controller id=2] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2018-01-12 15:53:04,771] DEBUG [Controller id=2] Live brokers: 2,4 (kafka.controller.KafkaController)
[2018-01-12 15:53:04,777] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,778] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=localdev.connect.grade.create,Partition=1,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,779] INFO [ReplicaStateMachine controllerId=2] Invoking state change to OfflineReplica for replicas [Topic=localdev.connect.grade.create,Partition=1,Replica=1] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:04,780] DEBUG [Controller id=2] Removing replica 1 from ISR 2,1,4 for partition localdev.connect.grade.create-1. (kafka.controller.KafkaController)
[2018-01-12 15:53:04,790] INFO [Controller id=2] New leader and ISR for partition localdev.connect.grade.create-1 is {"leader":2,"leader_epoch":2,"isr":[2,4]} (kafka.controller.KafkaController)
[2018-01-12 15:53:04,792] WARN [Channel manager on controller 2]: Not sending request (type=LeaderAndIsRequest, controllerId=2, controllerEpoch=3, partitionStates={localdev.connect.grade.create-1=PartitionState(controllerEpoch=3, leader=2, leaderEpoch=2, isr=2,4, zkVersion=2, replicas=2,1,4,0, isNew=false)}, liveLeaders=(localhost:9094 (id: 2 rack: null))) to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2018-01-12 15:53:04,792] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,792] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=localdev.connect.grade.create,Partition=1,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,792] INFO [PartitionStateMachine controllerId=2] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:04,796] DEBUG [ControlledShutdownLeaderSelector]: Partition localdev.connect.grade.create-0 : current leader = 1, new leader = 2 (kafka.controller.ControlledShutdownLeaderSelector)
[2018-01-12 15:53:04,799] DEBUG [PartitionStateMachine controllerId=2] After leader election, leader cache for localdev.connect.grade.create-0 is updated to (Leader:2,ISR:2,4,LeaderEpoch:2,ControllerEpoch:3) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:04,803] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,803] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=localdev.connect.assignment.update,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,803] INFO [ReplicaStateMachine controllerId=2] Invoking state change to OfflineReplica for replicas [Topic=localdev.connect.assignment.update,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:04,804] DEBUG [Controller id=2] Removing replica 1 from ISR 2,4,1 for partition localdev.connect.assignment.update-0. (kafka.controller.KafkaController)
[2018-01-12 15:53:04,810] INFO [Controller id=2] New leader and ISR for partition localdev.connect.assignment.update-0 is {"leader":2,"leader_epoch":2,"isr":[2,4]} (kafka.controller.KafkaController)
[2018-01-12 15:53:04,811] WARN [Channel manager on controller 2]: Not sending request (type=LeaderAndIsRequest, controllerId=2, controllerEpoch=3, partitionStates={localdev.connect.assignment.update-0=PartitionState(controllerEpoch=3, leader=2, leaderEpoch=2, isr=2,4, zkVersion=2, replicas=2,4,0,1, isNew=false)}, liveLeaders=(localhost:9094 (id: 2 rack: null))) to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2018-01-12 15:53:04,812] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,812] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=localdev.connect.assignment.update,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,813] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,813] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=localdev.connect.section.update,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,813] INFO [ReplicaStateMachine controllerId=2] Invoking state change to OfflineReplica for replicas [Topic=localdev.connect.section.update,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:04,813] DEBUG [Controller id=2] Removing replica 1 from ISR 4,2,1,0 for partition localdev.connect.section.update-0. (kafka.controller.KafkaController)
[2018-01-12 15:53:04,817] INFO [Controller id=2] New leader and ISR for partition localdev.connect.section.update-0 is {"leader":4,"leader_epoch":2,"isr":[4,2]} (kafka.controller.KafkaController)
[2018-01-12 15:53:04,821] WARN [Channel manager on controller 2]: Not sending request (type=LeaderAndIsRequest, controllerId=2, controllerEpoch=3, partitionStates={localdev.connect.section.update-0=PartitionState(controllerEpoch=3, leader=4, leaderEpoch=2, isr=4,2, zkVersion=4, replicas=4,2,0,1, isNew=false)}, liveLeaders=(localhost:9095 (id: 4 rack: null))) to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2018-01-12 15:53:04,822] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,822] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=localdev.connect.section.update,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:04,823] TRACE [Controller id=2] All leaders = localdev.connect.grade.create-1 -> (Leader:2,ISR:2,4,LeaderEpoch:2,ControllerEpoch:3),localdev.connect.grade.create-0 -> (Leader:2,ISR:2,4,LeaderEpoch:2,ControllerEpoch:3),localdev.connect.assignment.update-0 -> (Leader:2,ISR:2,4,LeaderEpoch:2,ControllerEpoch:3),localdev.connect.section.update-0 -> (Leader:4,ISR:4,2,LeaderEpoch:2,ControllerEpoch:3) (kafka.controller.KafkaController)
[2018-01-12 15:53:04,841] WARN [Controller-2-to-broker-1-send-thread]: Controller 2 epoch 3 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=3, deletePartitions=false, partitions=localdev.connect.section.update-0) to broker localhost:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:95)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:230)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:04,955] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,060] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,166] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,271] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,372] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,473] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,575] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,680] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,787] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,889] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:05,992] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:06,097] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:06,200] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:06,303] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:06,408] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:06,514] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:06,620] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:06,721] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:06,822] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:06,924] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:07,027] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:07,131] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:07,234] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:07,336] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:07,441] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:07,546] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:07,650] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:07,756] WARN [Controller-2-to-broker-1-send-thread]: Controller 2's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:07,844] INFO [controller-event-thread]: Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:53:07,844] INFO [controller-event-thread]: Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:53:07,844] INFO [controller-event-thread]: Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:53:07,844] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2018-01-12 15:53:07,845] DEBUG [Controller id=1] De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:53:07,846] DEBUG [Controller id=1] De-registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:53:07,847] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:07,848] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:07,849] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2018-01-12 15:53:07,859] INFO [Controller id=2] Newly added brokers: , deleted brokers: 1, all live brokers: 2,4 (kafka.controller.KafkaController)
[2018-01-12 15:53:07,860] INFO [Controller-2-to-broker-1-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-01-12 15:53:07,861] INFO [Controller-2-to-broker-1-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-01-12 15:53:07,861] INFO [Controller-2-to-broker-1-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-01-12 15:53:07,863] INFO [Controller id=2] Broker failure callback for 1 (kafka.controller.KafkaController)
[2018-01-12 15:53:07,864] INFO [Controller id=2] Removed Vector(1) from list of shutting down brokers. (kafka.controller.KafkaController)
[2018-01-12 15:53:07,865] INFO [PartitionStateMachine controllerId=2] Invoking state change to OfflinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:07,866] INFO [ReplicaStateMachine controllerId=2] Invoking state change to OfflineReplica for replicas [Topic=localdev.connect.grade.create,Partition=1,Replica=1],[Topic=localdev.connect.grade.create,Partition=0,Replica=1],[Topic=localdev.connect.assignment.update,Partition=0,Replica=1],[Topic=localdev.connect.section.update,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:07,866] DEBUG [Controller id=2] Removing replica 1 from ISR 2,4 for partition localdev.connect.grade.create-1. (kafka.controller.KafkaController)
[2018-01-12 15:53:07,868] WARN [Controller id=2] Cannot remove replica 1 from ISR of partition localdev.connect.grade.create-1 since it is not in the ISR. Leader = 2 ; ISR = List(2, 4) (kafka.controller.KafkaController)
[2018-01-12 15:53:07,869] DEBUG [Controller id=2] Removing replica 1 from ISR 2,4 for partition localdev.connect.grade.create-0. (kafka.controller.KafkaController)
[2018-01-12 15:53:07,869] WARN [Controller id=2] Cannot remove replica 1 from ISR of partition localdev.connect.grade.create-0 since it is not in the ISR. Leader = 2 ; ISR = List(2, 4) (kafka.controller.KafkaController)
[2018-01-12 15:53:07,870] DEBUG [Controller id=2] Removing replica 1 from ISR 2,4 for partition localdev.connect.assignment.update-0. (kafka.controller.KafkaController)
[2018-01-12 15:53:07,870] WARN [Controller id=2] Cannot remove replica 1 from ISR of partition localdev.connect.assignment.update-0 since it is not in the ISR. Leader = 2 ; ISR = List(2, 4) (kafka.controller.KafkaController)
[2018-01-12 15:53:07,871] DEBUG [Controller id=2] Removing replica 1 from ISR 4,2 for partition localdev.connect.section.update-0. (kafka.controller.KafkaController)
[2018-01-12 15:53:07,871] WARN [Controller id=2] Cannot remove replica 1 from ISR of partition localdev.connect.section.update-0 since it is not in the ISR. Leader = 4 ; ISR = List(4, 2) (kafka.controller.KafkaController)
[2018-01-12 15:53:07,872] WARN [Channel manager on controller 2]: Not sending request (type=LeaderAndIsRequest, controllerId=2, controllerEpoch=3, partitionStates={localdev.connect.assignment.update-0=PartitionState(controllerEpoch=3, leader=2, leaderEpoch=2, isr=2,4, zkVersion=2, replicas=2,4,0,1, isNew=false), localdev.connect.section.update-0=PartitionState(controllerEpoch=3, leader=4, leaderEpoch=2, isr=4,2, zkVersion=4, replicas=4,2,0,1, isNew=false), localdev.connect.grade.create-0=PartitionState(controllerEpoch=3, leader=2, leaderEpoch=2, isr=2,4, zkVersion=2, replicas=1,0,2,4, isNew=false), localdev.connect.grade.create-1=PartitionState(controllerEpoch=3, leader=2, leaderEpoch=2, isr=2,4, zkVersion=2, replicas=2,1,4,0, isNew=false)}, liveLeaders=(localhost:9094 (id: 2 rack: null), localhost:9095 (id: 4 rack: null))) to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2018-01-12 15:53:07,873] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:07,873] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=localdev.connect.grade.create,Partition=1,Replica=1],[Topic=localdev.connect.grade.create,Partition=0,Replica=1],[Topic=localdev.connect.assignment.update,Partition=0,Replica=1],[Topic=localdev.connect.section.update,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:07,873] WARN [Channel manager on controller 2]: Not sending request (type=StopReplicaRequest, controllerId=2, controllerEpoch=3, deletePartitions=false, partitions=localdev.connect.grade.create-1,localdev.connect.grade.create-0,localdev.connect.assignment.update-0,localdev.connect.section.update-0) to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2018-01-12 15:53:10,321] DEBUG [Controller id=2] Sending MetadataRequest to Brokers:Vector(2, 4) for TopicAndPartitions:Set(localdev.connect.section.update-0) (kafka.controller.KafkaController)
[2018-01-12 15:53:12,383] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2018-01-12 15:53:12,383] DEBUG [Controller id=2] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2018-01-12 15:53:12,383] DEBUG [Controller id=2] Live brokers: 4 (kafka.controller.KafkaController)
[2018-01-12 15:53:12,384] INFO [PartitionStateMachine controllerId=2] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-1 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:12,384] DEBUG [ControlledShutdownLeaderSelector]: Partition localdev.connect.grade.create-1 : current leader = 2, new leader = 4 (kafka.controller.ControlledShutdownLeaderSelector)
[2018-01-12 15:53:12,391] DEBUG [PartitionStateMachine controllerId=2] After leader election, leader cache for localdev.connect.grade.create-1 is updated to (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:12,392] INFO [PartitionStateMachine controllerId=2] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:12,393] DEBUG [ControlledShutdownLeaderSelector]: Partition localdev.connect.grade.create-0 : current leader = 2, new leader = 4 (kafka.controller.ControlledShutdownLeaderSelector)
[2018-01-12 15:53:12,395] DEBUG [PartitionStateMachine controllerId=2] After leader election, leader cache for localdev.connect.grade.create-0 is updated to (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:12,396] INFO [PartitionStateMachine controllerId=2] Invoking state change to OnlinePartition for partitions localdev.connect.assignment.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:12,397] DEBUG [ControlledShutdownLeaderSelector]: Partition localdev.connect.assignment.update-0 : current leader = 2, new leader = 4 (kafka.controller.ControlledShutdownLeaderSelector)
[2018-01-12 15:53:12,399] DEBUG [PartitionStateMachine controllerId=2] After leader election, leader cache for localdev.connect.assignment.update-0 is updated to (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:12,400] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:12,400] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=localdev.connect.section.update,Partition=0,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:12,400] INFO [ReplicaStateMachine controllerId=2] Invoking state change to OfflineReplica for replicas [Topic=localdev.connect.section.update,Partition=0,Replica=2] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:12,400] DEBUG [Controller id=2] Removing replica 2 from ISR 4,2 for partition localdev.connect.section.update-0. (kafka.controller.KafkaController)
[2018-01-12 15:53:12,403] INFO [Controller id=2] New leader and ISR for partition localdev.connect.section.update-0 is {"leader":4,"leader_epoch":3,"isr":[4]} (kafka.controller.KafkaController)
[2018-01-12 15:53:12,403] WARN [Channel manager on controller 2]: Not sending request (type=LeaderAndIsRequest, controllerId=2, controllerEpoch=3, partitionStates={localdev.connect.section.update-0=PartitionState(controllerEpoch=3, leader=4, leaderEpoch=3, isr=4, zkVersion=5, replicas=4,2,0,1, isNew=false)}, liveLeaders=(localhost:9095 (id: 4 rack: null))) to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2018-01-12 15:53:12,404] WARN [Channel manager on controller 2]: Not sending request (type=LeaderAndIsRequest, controllerId=2, controllerEpoch=3, partitionStates={localdev.connect.section.update-0=PartitionState(controllerEpoch=3, leader=4, leaderEpoch=3, isr=4, zkVersion=5, replicas=4,2,0,1, isNew=false)}, liveLeaders=(localhost:9095 (id: 4 rack: null))) to broker 0, since it is offline. (kafka.controller.ControllerChannelManager)
[2018-01-12 15:53:12,404] DEBUG The stop replica request (delete = true) sent to broker 2 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:12,404] DEBUG The stop replica request (delete = false) sent to broker 2 is [Topic=localdev.connect.section.update,Partition=0,Replica=2] (kafka.controller.ControllerBrokerRequestBatch)
[2018-01-12 15:53:12,404] TRACE [Controller id=2] All leaders = localdev.connect.grade.create-1 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.grade.create-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.assignment.update-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.section.update-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3) (kafka.controller.KafkaController)
[2018-01-12 15:53:12,417] WARN [Controller-2-to-broker-2-send-thread]: Controller 2 epoch 3 fails to send request (type=StopReplicaRequest, controllerId=2, controllerEpoch=3, deletePartitions=false, partitions=localdev.connect.section.update-0) to broker localhost:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:95)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:230)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:12,519] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:12,621] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:12,724] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:12,827] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:12,930] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,032] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,134] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,235] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,341] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,442] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,547] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,651] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,754] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,856] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:13,961] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,066] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,169] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,272] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,373] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,475] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,581] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,686] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,788] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,894] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:14,996] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:15,098] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:15,204] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:15,310] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:15,415] WARN [Controller-2-to-broker-2-send-thread]: Controller 2's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2018-01-12 15:53:15,507] INFO [controller-event-thread]: Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:53:15,507] INFO [controller-event-thread]: Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:53:15,507] INFO [controller-event-thread]: Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:53:15,508] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2018-01-12 15:53:15,508] DEBUG [Controller id=2] De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:53:15,509] DEBUG [Controller id=2] De-registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:53:15,510] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:15,510] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:15,511] INFO [Controller-2-to-broker-2-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-01-12 15:53:15,511] INFO [Controller-2-to-broker-2-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-01-12 15:53:15,511] INFO [Controller-2-to-broker-2-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-01-12 15:53:15,512] INFO [Controller-2-to-broker-4-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-01-12 15:53:15,512] INFO [Controller-2-to-broker-4-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-01-12 15:53:15,512] INFO [Controller-2-to-broker-4-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-01-12 15:53:15,514] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2018-01-12 15:53:15,521] INFO [Controller id=4] 4 successfully elected as the controller (kafka.controller.KafkaController)
[2018-01-12 15:53:15,522] INFO [Controller id=4] Starting become controller state transition (kafka.controller.KafkaController)
[2018-01-12 15:53:15,524] INFO [Controller id=4] Initialized controller epoch to 3 and zk version 2 (kafka.controller.KafkaController)
[2018-01-12 15:53:15,526] INFO [Controller id=4] Incremented epoch to 4 (kafka.controller.KafkaController)
[2018-01-12 15:53:15,530] DEBUG [Controller id=4] Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:53:15,533] DEBUG [Controller id=4] Registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:53:15,565] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:53:15,570] INFO [Controller-4-to-broker-4-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:53:15,571] INFO [Controller id=4] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-01-12 15:53:15,571] INFO [Controller id=4] Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2018-01-12 15:53:15,574] INFO [Controller id=4] Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-01-12 15:53:15,574] INFO [Controller id=4] Currently active brokers in the cluster: Set(4) (kafka.controller.KafkaController)
[2018-01-12 15:53:15,574] INFO [Controller id=4] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-01-12 15:53:15,575] INFO [Controller id=4] Current list of topics in the cluster: Set(localdev.connect.grade.create, localdev.connect.section.update, localdev.connect.assignment.update) (kafka.controller.KafkaController)
[2018-01-12 15:53:15,578] INFO [Controller id=4] List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-01-12 15:53:15,578] INFO [Controller id=4] List of topics ineligible for deletion: localdev.connect.grade.create,localdev.connect.assignment.update,localdev.connect.section.update (kafka.controller.KafkaController)
[2018-01-12 15:53:15,589] INFO [Controller-4-to-broker-4-send-thread]: Controller 4 connected to localhost:9095 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:53:15,597] INFO [ReplicaStateMachine controllerId=4] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.grade.create,Partition=1,Replica=4],[Topic=localdev.connect.grade.create,Partition=0,Replica=4],[Topic=localdev.connect.assignment.update,Partition=0,Replica=4],[Topic=localdev.connect.section.update,Partition=0,Replica=4] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:15,605] INFO [ReplicaStateMachine controllerId=4] Started replica state machine with initial state -> Map([Topic=localdev.connect.assignment.update,Partition=0,Replica=4] -> OnlineReplica, [Topic=localdev.connect.section.update,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.section.update,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=localdev.connect.assignment.update,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=localdev.connect.assignment.update,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=localdev.connect.section.update,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=localdev.connect.assignment.update,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=4] -> OnlineReplica, [Topic=localdev.connect.grade.create,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=1] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=4] -> OnlineReplica, [Topic=localdev.connect.section.update,Partition=0,Replica=4] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:15,610] INFO [PartitionStateMachine controllerId=4] Started partition state machine with initial state -> Map(localdev.connect.grade.create-1 -> OnlinePartition, localdev.connect.grade.create-0 -> OnlinePartition, localdev.connect.assignment.update-0 -> OnlinePartition, localdev.connect.section.update-0 -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:15,612] INFO [Controller id=4] Ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2018-01-12 15:53:15,614] INFO [Controller id=4] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-01-12 15:53:15,614] INFO [Controller id=4] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-01-12 15:53:15,615] INFO [Controller id=4] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2018-01-12 15:53:15,615] INFO [Controller id=4] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-01-12 15:53:15,615] INFO [Controller id=4] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-01-12 15:53:15,615] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:15,620] INFO [Controller id=4] Starting the controller scheduler (kafka.controller.KafkaController)
[2018-01-12 15:53:15,780] INFO [Controller id=4] Shutting down broker 4 (kafka.controller.KafkaController)
[2018-01-12 15:53:15,780] DEBUG [Controller id=4] All shutting down brokers: 4 (kafka.controller.KafkaController)
[2018-01-12 15:53:15,781] DEBUG [Controller id=4] Live brokers:  (kafka.controller.KafkaController)
[2018-01-12 15:53:15,782] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-1 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:15,789] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:15,791] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.assignment.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:15,792] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.section.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:15,794] TRACE [Controller id=4] All leaders = localdev.connect.grade.create-1 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.grade.create-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.assignment.update-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.section.update-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3) (kafka.controller.KafkaController)
[2018-01-12 15:53:20,626] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:53:20,628] DEBUG [Controller id=4] Preferred replicas by broker Map(2 -> Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1)), 4 -> Map(localdev.connect.section.update-0 -> Vector(4, 2, 0, 1)), 1 -> Map(localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4))) (kafka.controller.KafkaController)
[2018-01-12 15:53:20,629] DEBUG [Controller id=4] Topics not in preferred replica Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1)) (kafka.controller.KafkaController)
[2018-01-12 15:53:20,630] TRACE [Controller id=4] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2018-01-12 15:53:20,631] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:53:20,631] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:53:20,631] DEBUG [Controller id=4] Topics not in preferred replica Map(localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4)) (kafka.controller.KafkaController)
[2018-01-12 15:53:20,631] TRACE [Controller id=4] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2018-01-12 15:53:20,799] INFO [Controller id=4] Shutting down broker 4 (kafka.controller.KafkaController)
[2018-01-12 15:53:20,799] DEBUG [Controller id=4] All shutting down brokers: 4 (kafka.controller.KafkaController)
[2018-01-12 15:53:20,799] DEBUG [Controller id=4] Live brokers:  (kafka.controller.KafkaController)
[2018-01-12 15:53:20,800] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-1 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:20,801] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:20,802] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.assignment.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:20,803] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.section.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:20,804] TRACE [Controller id=4] All leaders = localdev.connect.grade.create-1 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.grade.create-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.assignment.update-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.section.update-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3) (kafka.controller.KafkaController)
[2018-01-12 15:53:25,810] INFO [Controller id=4] Shutting down broker 4 (kafka.controller.KafkaController)
[2018-01-12 15:53:25,810] DEBUG [Controller id=4] All shutting down brokers: 4 (kafka.controller.KafkaController)
[2018-01-12 15:53:25,810] DEBUG [Controller id=4] Live brokers:  (kafka.controller.KafkaController)
[2018-01-12 15:53:25,810] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-1 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:25,812] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:25,814] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.assignment.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:25,815] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.section.update-0 (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:25,817] TRACE [Controller id=4] All leaders = localdev.connect.grade.create-1 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.grade.create-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.assignment.update-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3),localdev.connect.section.update-0 -> (Leader:4,ISR:4,LeaderEpoch:3,ControllerEpoch:3) (kafka.controller.KafkaController)
[2018-01-12 15:53:34,310] INFO [controller-event-thread]: Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:53:34,310] INFO [controller-event-thread]: Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:53:34,310] INFO [controller-event-thread]: Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:53:34,310] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2018-01-12 15:53:34,311] DEBUG [Controller id=4] De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:53:34,311] DEBUG [Controller id=4] De-registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:53:34,312] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-01-12 15:53:34,313] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:53:34,314] INFO [Controller-4-to-broker-4-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-01-12 15:53:34,314] INFO [Controller-4-to-broker-4-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-01-12 15:53:34,314] INFO [Controller-4-to-broker-4-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-01-12 15:53:34,316] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2018-01-12 15:54:15,893] INFO [controller-event-thread]: Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:54:15,915] INFO [Controller id=0] 0 successfully elected as the controller (kafka.controller.KafkaController)
[2018-01-12 15:54:15,915] INFO [Controller id=0] Starting become controller state transition (kafka.controller.KafkaController)
[2018-01-12 15:54:15,918] INFO [Controller id=0] Initialized controller epoch to 4 and zk version 3 (kafka.controller.KafkaController)
[2018-01-12 15:54:15,922] INFO [Controller id=0] Incremented epoch to 5 (kafka.controller.KafkaController)
[2018-01-12 15:54:15,926] DEBUG [Controller id=0] Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:54:15,933] DEBUG [Controller id=0] Registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-12 15:54:15,986] INFO [Controller id=0] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-01-12 15:54:15,986] INFO [Controller id=0] Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2018-01-12 15:54:15,987] INFO [Controller id=0] Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-01-12 15:54:15,989] INFO [Controller id=0] Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-01-12 15:54:15,989] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-01-12 15:54:15,989] INFO [Controller id=0] Current list of topics in the cluster: Set(localdev.connect.grade.create, localdev.connect.section.update, localdev.connect.assignment.update) (kafka.controller.KafkaController)
[2018-01-12 15:54:15,994] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-01-12 15:54:15,994] INFO [Controller id=0] List of topics ineligible for deletion: localdev.connect.grade.create,localdev.connect.assignment.update,localdev.connect.section.update (kafka.controller.KafkaController)
[2018-01-12 15:54:16,015] INFO [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map([Topic=localdev.connect.assignment.update,Partition=0,Replica=4] -> ReplicaDeletionIneligible, [Topic=localdev.connect.section.update,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.section.update,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=localdev.connect.assignment.update,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=localdev.connect.assignment.update,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=2] -> ReplicaDeletionIneligible, [Topic=localdev.connect.section.update,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=localdev.connect.assignment.update,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=4] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=1] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=1] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=4] -> ReplicaDeletionIneligible, [Topic=localdev.connect.section.update,Partition=0,Replica=4] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:54:16,037] INFO [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map(localdev.connect.grade.create-1 -> OfflinePartition, localdev.connect.grade.create-0 -> OfflinePartition, localdev.connect.assignment.update-0 -> OfflinePartition, localdev.connect.section.update-0 -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:54:16,044] INFO [Controller id=0] Ready to serve as the new controller with epoch 5 (kafka.controller.KafkaController)
[2018-01-12 15:54:16,053] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-01-12 15:54:16,054] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-01-12 15:54:16,054] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2018-01-12 15:54:16,054] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-01-12 15:54:16,055] INFO [Controller id=0] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-01-12 15:54:16,055] INFO [PartitionStateMachine controllerId=0] Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-01-12 15:54:16,058] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2018-01-12 15:54:16,075] INFO [Controller id=0] Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2018-01-12 15:54:16,076] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:54:16,081] INFO [Controller-0-to-broker-0-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:54:16,082] INFO [Controller id=0] New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-01-12 15:54:16,096] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.grade.create,Partition=1,Replica=0],[Topic=localdev.connect.grade.create,Partition=0,Replica=0],[Topic=localdev.connect.assignment.update,Partition=0,Replica=0],[Topic=localdev.connect.section.update,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:54:16,100] INFO [Controller-0-to-broker-0-send-thread]: Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:54:21,063] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:54:21,065] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1)), 4 -> Map(localdev.connect.section.update-0 -> Vector(4, 2, 0, 1)), 1 -> Map(localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4))) (kafka.controller.KafkaController)
[2018-01-12 15:54:21,066] DEBUG [Controller id=0] Topics not in preferred replica Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1)) (kafka.controller.KafkaController)
[2018-01-12 15:54:21,067] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2018-01-12 15:54:21,068] DEBUG [Controller id=0] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:54:21,068] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:54:21,068] DEBUG [Controller id=0] Topics not in preferred replica Map(localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4)) (kafka.controller.KafkaController)
[2018-01-12 15:54:21,068] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2018-01-12 15:54:33,499] INFO [controller-event-thread]: Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:54:33,508] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2018-01-12 15:54:33,658] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2018-01-12 15:54:33,658] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:54:33,662] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2018-01-12 15:54:33,662] INFO [Controller-0-to-broker-3-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:54:33,666] INFO [Controller-0-to-broker-3-send-thread]: Controller 0 connected to localhost:9093 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:55:21,059] INFO [controller-event-thread]: Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-01-12 15:55:21,069] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2018-01-12 15:55:21,219] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2018-01-12 15:55:21,219] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2018-01-12 15:55:21,222] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2018-01-12 15:55:21,222] INFO [Controller-0-to-broker-4-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-12 15:55:21,224] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.grade.create,Partition=1,Replica=4],[Topic=localdev.connect.grade.create,Partition=0,Replica=4],[Topic=localdev.connect.assignment.update,Partition=0,Replica=4],[Topic=localdev.connect.section.update,Partition=0,Replica=4] (kafka.controller.ReplicaStateMachine)
[2018-01-12 15:55:21,231] INFO [Controller-0-to-broker-4-send-thread]: Controller 0 connected to localhost:9094 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-12 15:55:21,236] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for localdev.connect.grade.create-1. Select 4 from ISR 4 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-12 15:55:21,236] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":4,"leader_epoch":4,"isr":[4]} for offline partition localdev.connect.grade.create-1 (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-12 15:55:21,241] DEBUG [PartitionStateMachine controllerId=0] After leader election, leader cache for localdev.connect.grade.create-1 is updated to (Leader:4,ISR:4,LeaderEpoch:4,ControllerEpoch:5) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:55:21,244] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for localdev.connect.grade.create-0. Select 4 from ISR 4 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-12 15:55:21,244] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":4,"leader_epoch":4,"isr":[4]} for offline partition localdev.connect.grade.create-0 (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-12 15:55:21,246] DEBUG [PartitionStateMachine controllerId=0] After leader election, leader cache for localdev.connect.grade.create-0 is updated to (Leader:4,ISR:4,LeaderEpoch:4,ControllerEpoch:5) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:55:21,248] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for localdev.connect.assignment.update-0. Select 4 from ISR 4 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-12 15:55:21,248] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":4,"leader_epoch":4,"isr":[4]} for offline partition localdev.connect.assignment.update-0 (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-12 15:55:21,249] DEBUG [PartitionStateMachine controllerId=0] After leader election, leader cache for localdev.connect.assignment.update-0 is updated to (Leader:4,ISR:4,LeaderEpoch:4,ControllerEpoch:5) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:55:21,250] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for localdev.connect.section.update-0. Select 4 from ISR 4 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-12 15:55:21,250] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":4,"leader_epoch":4,"isr":[4]} for offline partition localdev.connect.section.update-0 (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-12 15:55:21,252] DEBUG [PartitionStateMachine controllerId=0] After leader election, leader cache for localdev.connect.section.update-0 is updated to (Leader:4,ISR:4,LeaderEpoch:4,ControllerEpoch:5) (kafka.controller.PartitionStateMachine)
[2018-01-12 15:55:28,541] DEBUG [Controller id=0] Sending MetadataRequest to Brokers:Vector(0, 3, 4) for TopicAndPartitions:Set(localdev.connect.assignment.update-0, localdev.connect.grade.create-0, localdev.connect.grade.create-1, localdev.connect.section.update-0) (kafka.controller.KafkaController)
[2018-01-12 15:59:21,073] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-12 15:59:21,074] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1)), 4 -> Map(localdev.connect.section.update-0 -> Vector(4, 2, 0, 1)), 1 -> Map(localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4))) (kafka.controller.KafkaController)
[2018-01-12 15:59:21,074] DEBUG [Controller id=0] Topics not in preferred replica Map(localdev.connect.grade.create-1 -> Vector(2, 1, 4, 0), localdev.connect.assignment.update-0 -> Vector(2, 4, 0, 1)) (kafka.controller.KafkaController)
[2018-01-12 15:59:21,074] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2018-01-12 15:59:21,074] DEBUG [Controller id=0] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-12 15:59:21,074] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-12 15:59:21,074] DEBUG [Controller id=0] Topics not in preferred replica Map(localdev.connect.grade.create-0 -> Vector(1, 0, 2, 4)) (kafka.controller.KafkaController)
[2018-01-12 15:59:21,074] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
