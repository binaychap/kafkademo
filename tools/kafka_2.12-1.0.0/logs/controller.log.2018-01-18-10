[2018-01-18 11:40:54,699] INFO [Controller id=4] 4 successfully elected as the controller (kafka.controller.KafkaController)
[2018-01-18 11:40:54,700] INFO [Controller id=4] Starting become controller state transition (kafka.controller.KafkaController)
[2018-01-18 11:40:54,703] INFO [Controller id=4] Initialized controller epoch to 1 and zk version 0 (kafka.controller.KafkaController)
[2018-01-18 11:40:54,704] INFO [Controller id=4] Incremented epoch to 2 (kafka.controller.KafkaController)
[2018-01-18 11:40:54,708] DEBUG [Controller id=4] Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-01-18 11:40:54,712] DEBUG [Controller id=4] Registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-01-18 11:40:54,747] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2018-01-18 11:40:54,752] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2018-01-18 11:40:54,755] INFO [Controller-4-to-broker-3-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-18 11:40:54,755] INFO [Controller-4-to-broker-4-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-18 11:40:54,757] INFO [Controller id=4] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-01-18 11:40:54,757] INFO [Controller id=4] Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2018-01-18 11:40:54,758] INFO [Controller id=4] Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-01-18 11:40:54,758] INFO [Controller id=4] Currently active brokers in the cluster: Set(3, 4) (kafka.controller.KafkaController)
[2018-01-18 11:40:54,759] INFO [Controller id=4] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-01-18 11:40:54,759] INFO [Controller id=4] Current list of topics in the cluster: Set(localdev.connect.grade.create, localdev.connect.section.update, localdev.connect.assignment.update) (kafka.controller.KafkaController)
[2018-01-18 11:40:54,762] INFO [Controller id=4] List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-01-18 11:40:54,763] INFO [Controller id=4] List of topics ineligible for deletion: localdev.connect.grade.create,localdev.connect.assignment.update,localdev.connect.section.update (kafka.controller.KafkaController)
[2018-01-18 11:40:54,776] INFO [Controller-4-to-broker-3-send-thread]: Controller 4 connected to localhost:9093 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-18 11:40:54,776] INFO [Controller-4-to-broker-4-send-thread]: Controller 4 connected to localhost:9094 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-18 11:40:54,792] INFO [ReplicaStateMachine controllerId=4] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.section.update,Partition=0,Replica=4],[Topic=localdev.connect.grade.create,Partition=0,Replica=3],[Topic=localdev.connect.section.update,Partition=0,Replica=3],[Topic=localdev.connect.assignment.update,Partition=0,Replica=3],[Topic=localdev.connect.grade.create,Partition=1,Replica=3],[Topic=localdev.connect.assignment.update,Partition=0,Replica=4],[Topic=localdev.connect.grade.create,Partition=1,Replica=4],[Topic=localdev.connect.grade.create,Partition=0,Replica=4] (kafka.controller.ReplicaStateMachine)
[2018-01-18 11:40:54,804] INFO [ReplicaStateMachine controllerId=4] Started replica state machine with initial state -> Map([Topic=localdev.connect.assignment.update,Partition=0,Replica=4] -> OnlineReplica, [Topic=localdev.connect.section.update,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=3] -> OnlineReplica, [Topic=localdev.connect.assignment.update,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=3] -> OnlineReplica, [Topic=localdev.connect.grade.create,Partition=1,Replica=5] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=5] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=4] -> OnlineReplica, [Topic=localdev.connect.grade.create,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=localdev.connect.section.update,Partition=0,Replica=3] -> OnlineReplica, [Topic=localdev.connect.assignment.update,Partition=0,Replica=5] -> ReplicaDeletionIneligible, [Topic=localdev.connect.section.update,Partition=0,Replica=5] -> ReplicaDeletionIneligible, [Topic=localdev.connect.grade.create,Partition=0,Replica=4] -> OnlineReplica, [Topic=localdev.connect.assignment.update,Partition=0,Replica=3] -> OnlineReplica, [Topic=localdev.connect.section.update,Partition=0,Replica=4] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2018-01-18 11:40:54,817] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for localdev.connect.grade.create-1. Select 3 from ISR 4,3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-18 11:40:54,818] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":1,"isr":[4,3]} for offline partition localdev.connect.grade.create-1 (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-18 11:40:54,821] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for localdev.connect.grade.create-1 is updated to (Leader:3,ISR:4,3,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2018-01-18 11:40:54,822] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for localdev.connect.grade.create-0. Select 3 from ISR 4,3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-18 11:40:54,822] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":1,"isr":[4,3]} for offline partition localdev.connect.grade.create-0 (kafka.controller.OfflinePartitionLeaderSelector)
[2018-01-18 11:40:54,824] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for localdev.connect.grade.create-0 is updated to (Leader:3,ISR:4,3,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2018-01-18 11:40:54,825] INFO [PartitionStateMachine controllerId=4] Started partition state machine with initial state -> Map(localdev.connect.grade.create-1 -> OnlinePartition, localdev.connect.grade.create-0 -> OnlinePartition, localdev.connect.assignment.update-0 -> OnlinePartition, localdev.connect.section.update-0 -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2018-01-18 11:40:54,830] INFO [Controller id=4] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2018-01-18 11:40:54,836] INFO [Controller id=4] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-01-18 11:40:54,836] INFO [Controller id=4] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-01-18 11:40:54,837] INFO [Controller id=4] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2018-01-18 11:40:54,838] INFO [Controller id=4] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-01-18 11:40:54,839] INFO [Controller id=4] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-01-18 11:40:54,839] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-01-18 11:40:54,849] INFO [Controller id=4] Starting the controller scheduler (kafka.controller.KafkaController)
[2018-01-18 11:40:54,863] INFO [Controller id=4] Newly added brokers: 5, deleted brokers: , all live brokers: 3,4,5 (kafka.controller.KafkaController)
[2018-01-18 11:40:54,863] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2018-01-18 11:40:54,867] INFO [Controller-4-to-broker-5-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-18 11:40:54,867] INFO [Controller id=4] New broker startup callback for 5 (kafka.controller.KafkaController)
[2018-01-18 11:40:54,869] INFO [ReplicaStateMachine controllerId=4] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.grade.create,Partition=1,Replica=5],[Topic=localdev.connect.grade.create,Partition=0,Replica=5],[Topic=localdev.connect.assignment.update,Partition=0,Replica=5],[Topic=localdev.connect.section.update,Partition=0,Replica=5] (kafka.controller.ReplicaStateMachine)
[2018-01-18 11:40:54,870] INFO [Controller-4-to-broker-5-send-thread]: Controller 4 connected to localhost:9095 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-18 11:40:54,920] INFO [Controller id=4] Newly added brokers: 0, deleted brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2018-01-18 11:40:54,920] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-01-18 11:40:54,924] INFO [Controller id=4] New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-01-18 11:40:54,926] INFO [ReplicaStateMachine controllerId=4] Invoking state change to OnlineReplica for replicas [Topic=localdev.connect.grade.create,Partition=1,Replica=0],[Topic=localdev.connect.grade.create,Partition=0,Replica=0],[Topic=localdev.connect.assignment.update,Partition=0,Replica=0],[Topic=localdev.connect.section.update,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-01-18 11:40:54,930] INFO [Controller-4-to-broker-0-send-thread]: Starting (kafka.controller.RequestSendThread)
[2018-01-18 11:40:54,931] INFO [Controller-4-to-broker-0-send-thread]: Controller 4 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2018-01-18 11:40:55,476] DEBUG [Controller id=4] Sending MetadataRequest to Brokers:Vector(0, 3, 4, 5) for TopicAndPartitions:Set(localdev.connect.assignment.update-0, localdev.connect.section.update-0) (kafka.controller.KafkaController)
[2018-01-18 11:40:56,121] DEBUG [Controller id=4] Sending MetadataRequest to Brokers:Vector(0, 3, 4, 5) for TopicAndPartitions:Set(localdev.connect.grade.create-0, localdev.connect.grade.create-1) (kafka.controller.KafkaController)
[2018-01-18 11:40:59,853] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-18 11:40:59,855] DEBUG [Controller id=4] Preferred replicas by broker Map(5 -> Map(localdev.connect.grade.create-0 -> Vector(5, 0, 3, 4)), 4 -> Map(localdev.connect.assignment.update-0 -> Vector(4, 0, 3, 5), localdev.connect.section.update-0 -> Vector(4, 5, 0, 3)), 0 -> Map(localdev.connect.grade.create-1 -> Vector(0, 3, 4, 5))) (kafka.controller.KafkaController)
[2018-01-18 11:40:59,856] DEBUG [Controller id=4] Topics not in preferred replica Map(localdev.connect.grade.create-0 -> Vector(5, 0, 3, 4)) (kafka.controller.KafkaController)
[2018-01-18 11:40:59,857] TRACE [Controller id=4] Leader imbalance ratio for broker 5 is 1.0 (kafka.controller.KafkaController)
[2018-01-18 11:40:59,858] INFO [Controller id=4] Starting preferred replica leader election for partitions localdev.connect.grade.create-0 (kafka.controller.KafkaController)
[2018-01-18 11:40:59,858] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-0 (kafka.controller.PartitionStateMachine)
[2018-01-18 11:40:59,860] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 3 for partition localdev.connect.grade.create-0 is not the preferred replica. Triggering preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2018-01-18 11:40:59,863] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for localdev.connect.grade.create-0 is updated to (Leader:5,ISR:4,3,5,0,LeaderEpoch:2,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2018-01-18 11:40:59,864] INFO [Controller id=4] Partition localdev.connect.grade.create-0 completed preferred replica leader election. New leader is 5 (kafka.controller.KafkaController)
[2018-01-18 11:40:59,864] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:40:59,864] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-18 11:40:59,865] DEBUG [Controller id=4] Topics not in preferred replica Map(localdev.connect.grade.create-1 -> Vector(0, 3, 4, 5)) (kafka.controller.KafkaController)
[2018-01-18 11:40:59,865] TRACE [Controller id=4] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2018-01-18 11:40:59,865] INFO [Controller id=4] Starting preferred replica leader election for partitions localdev.connect.grade.create-1 (kafka.controller.KafkaController)
[2018-01-18 11:40:59,865] INFO [PartitionStateMachine controllerId=4] Invoking state change to OnlinePartition for partitions localdev.connect.grade.create-1 (kafka.controller.PartitionStateMachine)
[2018-01-18 11:40:59,867] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 3 for partition localdev.connect.grade.create-1 is not the preferred replica. Triggering preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2018-01-18 11:40:59,871] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for localdev.connect.grade.create-1 is updated to (Leader:0,ISR:4,3,5,0,LeaderEpoch:2,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2018-01-18 11:40:59,873] INFO [Controller id=4] Partition localdev.connect.grade.create-1 completed preferred replica leader election. New leader is 0 (kafka.controller.KafkaController)
[2018-01-18 11:45:59,880] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-18 11:45:59,886] DEBUG [Controller id=4] Preferred replicas by broker Map(5 -> Map(localdev.connect.grade.create-0 -> Vector(5, 0, 3, 4)), 4 -> Map(localdev.connect.assignment.update-0 -> Vector(4, 0, 3, 5), localdev.connect.section.update-0 -> Vector(4, 5, 0, 3)), 0 -> Map(localdev.connect.grade.create-1 -> Vector(0, 3, 4, 5))) (kafka.controller.KafkaController)
[2018-01-18 11:45:59,886] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:45:59,886] TRACE [Controller id=4] Leader imbalance ratio for broker 5 is 0.0 (kafka.controller.KafkaController)
[2018-01-18 11:45:59,886] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:45:59,886] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-18 11:45:59,886] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:45:59,886] TRACE [Controller id=4] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2018-01-18 11:50:59,892] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-18 11:50:59,898] DEBUG [Controller id=4] Preferred replicas by broker Map(5 -> Map(localdev.connect.grade.create-0 -> Vector(5, 0, 3, 4)), 4 -> Map(localdev.connect.assignment.update-0 -> Vector(4, 0, 3, 5), localdev.connect.section.update-0 -> Vector(4, 5, 0, 3)), 0 -> Map(localdev.connect.grade.create-1 -> Vector(0, 3, 4, 5))) (kafka.controller.KafkaController)
[2018-01-18 11:50:59,898] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:50:59,898] TRACE [Controller id=4] Leader imbalance ratio for broker 5 is 0.0 (kafka.controller.KafkaController)
[2018-01-18 11:50:59,898] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:50:59,898] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-18 11:50:59,898] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:50:59,898] TRACE [Controller id=4] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2018-01-18 11:55:59,901] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-01-18 11:55:59,907] DEBUG [Controller id=4] Preferred replicas by broker Map(5 -> Map(localdev.connect.grade.create-0 -> Vector(5, 0, 3, 4)), 4 -> Map(localdev.connect.assignment.update-0 -> Vector(4, 0, 3, 5), localdev.connect.section.update-0 -> Vector(4, 5, 0, 3)), 0 -> Map(localdev.connect.grade.create-1 -> Vector(0, 3, 4, 5))) (kafka.controller.KafkaController)
[2018-01-18 11:55:59,907] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:55:59,907] TRACE [Controller id=4] Leader imbalance ratio for broker 5 is 0.0 (kafka.controller.KafkaController)
[2018-01-18 11:55:59,908] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:55:59,908] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2018-01-18 11:55:59,908] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-01-18 11:55:59,908] TRACE [Controller id=4] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
