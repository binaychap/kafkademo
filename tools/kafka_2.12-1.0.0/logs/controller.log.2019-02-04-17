[2019-02-05 07:35:11,709] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-02-05 07:35:11,719] DEBUG [Controller id=4] Preferred replicas by broker Map(4 -> Map(__consumer_offsets-30 -> Vector(4), __consumer_offsets-39 -> Vector(4), testtopic-0 -> Vector(4), __consumer_offsets-18 -> Vector(4), __consumer_offsets-0 -> Vector(4), __consumer_offsets-24 -> Vector(4), __consumer_offsets-33 -> Vector(4), __consumer_offsets-3 -> Vector(4), __consumer_offsets-21 -> Vector(4), __consumer_offsets-12 -> Vector(4), __consumer_offsets-15 -> Vector(4), __consumer_offsets-48 -> Vector(4), __consumer_offsets-6 -> Vector(4), __consumer_offsets-42 -> Vector(4), __consumer_offsets-27 -> Vector(4), __consumer_offsets-45 -> Vector(4), __consumer_offsets-36 -> Vector(4), create.employee-0 -> Vector(4, 0, 3), __consumer_offsets-9 -> Vector(4), create.assignment-0 -> Vector(4)), 3 -> Map(__consumer_offsets-47 -> Vector(3), __consumer_offsets-29 -> Vector(3), __consumer_offsets-41 -> Vector(3), __consumer_offsets-17 -> Vector(3), create.employee-2 -> Vector(3, 4, 0), __consumer_offsets-14 -> Vector(3), __consumer_offsets-26 -> Vector(3), __consumer_offsets-20 -> Vector(3), __consumer_offsets-5 -> Vector(3), __consumer_offsets-8 -> Vector(3), __consumer_offsets-23 -> Vector(3), __consumer_offsets-11 -> Vector(3), __consumer_offsets-44 -> Vector(3), __consumer_offsets-32 -> Vector(3), __consumer_offsets-35 -> Vector(3), __consumer_offsets-38 -> Vector(3), __consumer_offsets-2 -> Vector(3)), 0 -> Map(__consumer_offsets-19 -> Vector(0), __consumer_offsets-10 -> Vector(0), __consumer_offsets-40 -> Vector(0), __consumer_offsets-22 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-28 -> Vector(0), __consumer_offsets-4 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-34 -> Vector(0), __consumer_offsets-46 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-1 -> Vector(0), create.employee-1 -> Vector(0, 3, 4), __consumer_offsets-16 -> Vector(0))) (kafka.controller.KafkaController)
[2019-02-05 07:35:11,719] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2019-02-05 07:35:11,719] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2019-02-05 07:35:11,719] DEBUG [Controller id=4] Topics not in preferred replica Map(__consumer_offsets-47 -> Vector(3), __consumer_offsets-29 -> Vector(3), __consumer_offsets-41 -> Vector(3), __consumer_offsets-17 -> Vector(3), create.employee-2 -> Vector(3, 4, 0), __consumer_offsets-14 -> Vector(3), __consumer_offsets-26 -> Vector(3), __consumer_offsets-20 -> Vector(3), __consumer_offsets-5 -> Vector(3), __consumer_offsets-8 -> Vector(3), __consumer_offsets-23 -> Vector(3), __consumer_offsets-11 -> Vector(3), __consumer_offsets-44 -> Vector(3), __consumer_offsets-32 -> Vector(3), __consumer_offsets-35 -> Vector(3), __consumer_offsets-38 -> Vector(3), __consumer_offsets-2 -> Vector(3)) (kafka.controller.KafkaController)
[2019-02-05 07:35:11,719] TRACE [Controller id=4] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2019-02-05 07:35:11,720] DEBUG [Controller id=4] Topics not in preferred replica Map(create.employee-1 -> Vector(0, 3, 4)) (kafka.controller.KafkaController)
[2019-02-05 07:35:11,720] TRACE [Controller id=4] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2019-02-05 07:40:11,723] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-02-05 07:40:11,724] DEBUG [Controller id=4] Preferred replicas by broker Map(4 -> Map(__consumer_offsets-30 -> Vector(4), __consumer_offsets-39 -> Vector(4), testtopic-0 -> Vector(4), __consumer_offsets-18 -> Vector(4), __consumer_offsets-0 -> Vector(4), __consumer_offsets-24 -> Vector(4), __consumer_offsets-33 -> Vector(4), __consumer_offsets-3 -> Vector(4), __consumer_offsets-21 -> Vector(4), __consumer_offsets-12 -> Vector(4), __consumer_offsets-15 -> Vector(4), __consumer_offsets-48 -> Vector(4), __consumer_offsets-6 -> Vector(4), __consumer_offsets-42 -> Vector(4), __consumer_offsets-27 -> Vector(4), __consumer_offsets-45 -> Vector(4), __consumer_offsets-36 -> Vector(4), create.employee-0 -> Vector(4, 0, 3), __consumer_offsets-9 -> Vector(4), create.assignment-0 -> Vector(4)), 3 -> Map(__consumer_offsets-47 -> Vector(3), __consumer_offsets-29 -> Vector(3), __consumer_offsets-41 -> Vector(3), __consumer_offsets-17 -> Vector(3), create.employee-2 -> Vector(3, 4, 0), __consumer_offsets-14 -> Vector(3), __consumer_offsets-26 -> Vector(3), __consumer_offsets-20 -> Vector(3), __consumer_offsets-5 -> Vector(3), __consumer_offsets-8 -> Vector(3), __consumer_offsets-23 -> Vector(3), __consumer_offsets-11 -> Vector(3), __consumer_offsets-44 -> Vector(3), __consumer_offsets-32 -> Vector(3), __consumer_offsets-35 -> Vector(3), __consumer_offsets-38 -> Vector(3), __consumer_offsets-2 -> Vector(3)), 0 -> Map(__consumer_offsets-19 -> Vector(0), __consumer_offsets-10 -> Vector(0), __consumer_offsets-40 -> Vector(0), __consumer_offsets-22 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-28 -> Vector(0), __consumer_offsets-4 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-34 -> Vector(0), __consumer_offsets-46 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-1 -> Vector(0), create.employee-1 -> Vector(0, 3, 4), __consumer_offsets-16 -> Vector(0))) (kafka.controller.KafkaController)
[2019-02-05 07:40:11,724] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2019-02-05 07:40:11,724] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2019-02-05 07:40:11,724] DEBUG [Controller id=4] Topics not in preferred replica Map(__consumer_offsets-47 -> Vector(3), __consumer_offsets-29 -> Vector(3), __consumer_offsets-41 -> Vector(3), __consumer_offsets-17 -> Vector(3), create.employee-2 -> Vector(3, 4, 0), __consumer_offsets-14 -> Vector(3), __consumer_offsets-26 -> Vector(3), __consumer_offsets-20 -> Vector(3), __consumer_offsets-5 -> Vector(3), __consumer_offsets-8 -> Vector(3), __consumer_offsets-23 -> Vector(3), __consumer_offsets-11 -> Vector(3), __consumer_offsets-44 -> Vector(3), __consumer_offsets-32 -> Vector(3), __consumer_offsets-35 -> Vector(3), __consumer_offsets-38 -> Vector(3), __consumer_offsets-2 -> Vector(3)) (kafka.controller.KafkaController)
[2019-02-05 07:40:11,724] TRACE [Controller id=4] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2019-02-05 07:40:11,724] DEBUG [Controller id=4] Topics not in preferred replica Map(create.employee-1 -> Vector(0, 3, 4)) (kafka.controller.KafkaController)
[2019-02-05 07:40:11,724] TRACE [Controller id=4] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2019-02-05 07:42:46,777] INFO [controller-event-thread]: Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-02-05 07:42:46,783] DEBUG [Controller id=3] Broker 4 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2019-02-05 07:42:46,933] INFO [Controller id=4] Newly added brokers: 3, deleted brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2019-02-05 07:42:46,934] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2019-02-05 07:42:46,940] INFO [Controller id=4] New broker startup callback for 3 (kafka.controller.KafkaController)
[2019-02-05 07:42:46,940] INFO [Controller-4-to-broker-3-send-thread]: Starting (kafka.controller.RequestSendThread)
[2019-02-05 07:42:46,949] INFO [ReplicaStateMachine controllerId=4] Invoking state change to OnlineReplica for replicas [Topic=__consumer_offsets,Partition=35,Replica=3],[Topic=create.employee,Partition=2,Replica=3],[Topic=__consumer_offsets,Partition=17,Replica=3],[Topic=create.employee,Partition=0,Replica=3],[Topic=__consumer_offsets,Partition=47,Replica=3],[Topic=__consumer_offsets,Partition=38,Replica=3],[Topic=__consumer_offsets,Partition=8,Replica=3],[Topic=__consumer_offsets,Partition=29,Replica=3],[Topic=__consumer_offsets,Partition=23,Replica=3],[Topic=__consumer_offsets,Partition=32,Replica=3],[Topic=__consumer_offsets,Partition=26,Replica=3],[Topic=__consumer_offsets,Partition=41,Replica=3],[Topic=__consumer_offsets,Partition=11,Replica=3],[Topic=__consumer_offsets,Partition=20,Replica=3],[Topic=create.employee,Partition=1,Replica=3],[Topic=__consumer_offsets,Partition=14,Replica=3],[Topic=__consumer_offsets,Partition=2,Replica=3],[Topic=__consumer_offsets,Partition=44,Replica=3],[Topic=__consumer_offsets,Partition=5,Replica=3] (kafka.controller.ReplicaStateMachine)
[2019-02-05 07:42:46,952] INFO [Controller-4-to-broker-3-send-thread]: Controller 4 connected to localhost:9093 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-02-05 07:42:46,952] INFO [Controller-4-to-broker-0-send-thread]: Controller 4 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-02-05 07:42:46,953] INFO [Controller-4-to-broker-4-send-thread]: Controller 4 connected to localhost:9094 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-02-05 07:42:46,963] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-47. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,963] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-47 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,970] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-47 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,971] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-29. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,971] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-29 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,974] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-29 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,975] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-41. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,975] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-41 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,977] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-41 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,977] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-17. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,978] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-17 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,979] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-17 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,980] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-14. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,980] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-14 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,982] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-14 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,983] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-26. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,983] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-26 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,985] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-26 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,987] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-20. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,987] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-20 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,988] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-20 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,989] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-5. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,989] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-5 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,990] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-5 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,990] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-8. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,991] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-8 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,992] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-8 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,992] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-23. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,992] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-23 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,993] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-23 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,994] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-11. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,994] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-11 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,995] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-11 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,996] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-44. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,996] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-44 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,997] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-44 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:46,998] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-32. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:46,998] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-32 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:47,000] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-32 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:47,000] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-35. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:47,000] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-35 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:47,002] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-35 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:47,002] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-38. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:47,002] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-38 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:47,004] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-38 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:47,004] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for __consumer_offsets-2. Select 3 from ISR 3 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:47,005] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":3,"leader_epoch":6,"isr":[3]} for offline partition __consumer_offsets-2 (kafka.controller.OfflinePartitionLeaderSelector)
[2019-02-05 07:42:47,006] DEBUG [PartitionStateMachine controllerId=4] After leader election, leader cache for __consumer_offsets-2 is updated to (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.PartitionStateMachine)
[2019-02-05 07:42:47,750] DEBUG [Controller id=4] Sending MetadataRequest to Brokers:Vector(0, 3, 4) for TopicAndPartitions:Set(create.employee-1, create.employee-2, create.employee-0) (kafka.controller.KafkaController)
[2019-02-05 07:45:11,732] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-02-05 07:45:11,739] DEBUG [Controller id=4] Preferred replicas by broker Map(4 -> Map(__consumer_offsets-30 -> Vector(4), __consumer_offsets-39 -> Vector(4), testtopic-0 -> Vector(4), __consumer_offsets-18 -> Vector(4), __consumer_offsets-0 -> Vector(4), __consumer_offsets-24 -> Vector(4), __consumer_offsets-33 -> Vector(4), __consumer_offsets-3 -> Vector(4), __consumer_offsets-21 -> Vector(4), __consumer_offsets-12 -> Vector(4), __consumer_offsets-15 -> Vector(4), __consumer_offsets-48 -> Vector(4), __consumer_offsets-6 -> Vector(4), __consumer_offsets-42 -> Vector(4), __consumer_offsets-27 -> Vector(4), __consumer_offsets-45 -> Vector(4), __consumer_offsets-36 -> Vector(4), create.employee-0 -> Vector(4, 0, 3), __consumer_offsets-9 -> Vector(4), create.assignment-0 -> Vector(4)), 3 -> Map(__consumer_offsets-47 -> Vector(3), __consumer_offsets-29 -> Vector(3), __consumer_offsets-41 -> Vector(3), __consumer_offsets-17 -> Vector(3), create.employee-2 -> Vector(3, 4, 0), __consumer_offsets-14 -> Vector(3), __consumer_offsets-26 -> Vector(3), __consumer_offsets-20 -> Vector(3), __consumer_offsets-5 -> Vector(3), __consumer_offsets-8 -> Vector(3), __consumer_offsets-23 -> Vector(3), __consumer_offsets-11 -> Vector(3), __consumer_offsets-44 -> Vector(3), __consumer_offsets-32 -> Vector(3), __consumer_offsets-35 -> Vector(3), __consumer_offsets-38 -> Vector(3), __consumer_offsets-2 -> Vector(3)), 0 -> Map(__consumer_offsets-19 -> Vector(0), __consumer_offsets-10 -> Vector(0), __consumer_offsets-40 -> Vector(0), __consumer_offsets-22 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-28 -> Vector(0), __consumer_offsets-4 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-34 -> Vector(0), __consumer_offsets-46 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-1 -> Vector(0), create.employee-1 -> Vector(0, 3, 4), __consumer_offsets-16 -> Vector(0))) (kafka.controller.KafkaController)
[2019-02-05 07:45:11,739] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2019-02-05 07:45:11,739] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2019-02-05 07:45:11,739] DEBUG [Controller id=4] Topics not in preferred replica Map(create.employee-2 -> Vector(3, 4, 0)) (kafka.controller.KafkaController)
[2019-02-05 07:45:11,739] TRACE [Controller id=4] Leader imbalance ratio for broker 3 is 0.058823529411764705 (kafka.controller.KafkaController)
[2019-02-05 07:45:11,739] DEBUG [Controller id=4] Topics not in preferred replica Map(create.employee-1 -> Vector(0, 3, 4)) (kafka.controller.KafkaController)
[2019-02-05 07:45:11,739] TRACE [Controller id=4] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2019-02-05 07:48:52,614] INFO [Controller id=4] Shutting down broker 3 (kafka.controller.KafkaController)
[2019-02-05 07:48:52,614] DEBUG [Controller id=4] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2019-02-05 07:48:52,615] DEBUG [Controller id=4] Live brokers: 0,4 (kafka.controller.KafkaController)
[2019-02-05 07:48:52,615] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,616] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=create.employee,Partition=0,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,616] INFO [ReplicaStateMachine controllerId=4] Invoking state change to OfflineReplica for replicas [Topic=create.employee,Partition=0,Replica=3] (kafka.controller.ReplicaStateMachine)
[2019-02-05 07:48:52,616] DEBUG [Controller id=4] Removing replica 3 from ISR 4,0,3 for partition create.employee-0. (kafka.controller.KafkaController)
[2019-02-05 07:48:52,618] INFO [Controller id=4] New leader and ISR for partition create.employee-0 is {"leader":4,"leader_epoch":5,"isr":[4,0]} (kafka.controller.KafkaController)
[2019-02-05 07:48:52,619] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,619] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=create.employee,Partition=0,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,620] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,620] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=create.employee,Partition=1,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,620] INFO [ReplicaStateMachine controllerId=4] Invoking state change to OfflineReplica for replicas [Topic=create.employee,Partition=1,Replica=3] (kafka.controller.ReplicaStateMachine)
[2019-02-05 07:48:52,620] DEBUG [Controller id=4] Removing replica 3 from ISR 4,0,3 for partition create.employee-1. (kafka.controller.KafkaController)
[2019-02-05 07:48:52,628] INFO [Controller id=4] New leader and ISR for partition create.employee-1 is {"leader":4,"leader_epoch":6,"isr":[4,0]} (kafka.controller.KafkaController)
[2019-02-05 07:48:52,629] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,629] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=create.employee,Partition=1,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,630] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,630] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=create.employee,Partition=2,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,630] INFO [ReplicaStateMachine controllerId=4] Invoking state change to OfflineReplica for replicas [Topic=create.employee,Partition=2,Replica=3] (kafka.controller.ReplicaStateMachine)
[2019-02-05 07:48:52,630] DEBUG [Controller id=4] Removing replica 3 from ISR 4,0,3 for partition create.employee-2. (kafka.controller.KafkaController)
[2019-02-05 07:48:52,635] INFO [Controller id=4] New leader and ISR for partition create.employee-2 is {"leader":4,"leader_epoch":5,"isr":[4,0]} (kafka.controller.KafkaController)
[2019-02-05 07:48:52,636] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,636] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=create.employee,Partition=2,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:52,636] TRACE [Controller id=4] All leaders = __consumer_offsets-19 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-30 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-47 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-29 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-41 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-39 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-17 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),create.employee-2 -> (Leader:4,ISR:4,0,LeaderEpoch:5,ControllerEpoch:4),__consumer_offsets-14 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),testtopic-0 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:1),__consumer_offsets-18 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-26 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-0 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-24 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-33 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-20 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-3 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-21 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-5 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-12 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-8 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-23 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-15 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-11 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-48 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-13 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-6 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-44 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-42 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-45 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-27 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-32 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),create.employee-0 -> (Leader:4,ISR:4,0,LeaderEpoch:5,ControllerEpoch:4),__consumer_offsets-36 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-35 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),__consumer_offsets-9 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-38 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),create.assignment-0 -> (Leader:4,ISR:4,LeaderEpoch:0,ControllerEpoch:3),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),create.employee-1 -> (Leader:4,ISR:4,0,LeaderEpoch:6,ControllerEpoch:4),__consumer_offsets-2 -> (Leader:3,ISR:3,LeaderEpoch:6,ControllerEpoch:4) (kafka.controller.KafkaController)
[2019-02-05 07:48:52,652] WARN [Controller-4-to-broker-3-send-thread]: Controller 4 epoch 4 fails to send request (type=StopReplicaRequest, controllerId=4, controllerEpoch=4, deletePartitions=false, partitions=create.employee-2) to broker localhost:9093 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:95)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:230)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:52,759] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:52,864] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:52,968] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:53,071] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:53,175] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:53,277] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:53,381] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:53,482] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:53,586] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:53,691] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:53,793] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:53,898] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,000] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,103] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,208] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,311] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,414] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,518] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,625] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,730] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,834] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:54,936] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,042] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,146] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,248] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,349] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,451] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,556] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,660] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,764] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,865] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:55,969] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:56,073] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:56,177] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:56,283] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:56,385] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:56,489] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:56,593] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:56,697] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:56,802] WARN [Controller-4-to-broker-3-send-thread]: Controller 4's connection to broker localhost:9093 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:68)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:269)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:223)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
[2019-02-05 07:48:56,850] INFO [controller-event-thread]: Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-02-05 07:48:56,850] INFO [controller-event-thread]: Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-02-05 07:48:56,850] INFO [controller-event-thread]: Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-02-05 07:48:56,851] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2019-02-05 07:48:56,851] DEBUG [Controller id=3] De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2019-02-05 07:48:56,854] DEBUG [Controller id=3] De-registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2019-02-05 07:48:56,855] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2019-02-05 07:48:56,856] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2019-02-05 07:48:56,857] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2019-02-05 07:48:56,864] INFO [Controller id=4] Newly added brokers: , deleted brokers: 3, all live brokers: 0,4 (kafka.controller.KafkaController)
[2019-02-05 07:48:56,865] INFO [Controller-4-to-broker-3-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2019-02-05 07:48:56,866] INFO [Controller-4-to-broker-3-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2019-02-05 07:48:56,866] INFO [Controller-4-to-broker-3-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2019-02-05 07:48:56,868] INFO [Controller id=4] Broker failure callback for 3 (kafka.controller.KafkaController)
[2019-02-05 07:48:56,868] INFO [Controller id=4] Removed Vector(3) from list of shutting down brokers. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,868] INFO [PartitionStateMachine controllerId=4] Invoking state change to OfflinePartition for partitions __consumer_offsets-47,__consumer_offsets-29,__consumer_offsets-41,__consumer_offsets-17,__consumer_offsets-14,__consumer_offsets-26,__consumer_offsets-20,__consumer_offsets-5,__consumer_offsets-8,__consumer_offsets-23,__consumer_offsets-11,__consumer_offsets-44,__consumer_offsets-32,__consumer_offsets-35,__consumer_offsets-38,__consumer_offsets-2 (kafka.controller.PartitionStateMachine)
[2019-02-05 07:48:56,898] INFO [ReplicaStateMachine controllerId=4] Invoking state change to OfflineReplica for replicas [Topic=__consumer_offsets,Partition=35,Replica=3],[Topic=create.employee,Partition=2,Replica=3],[Topic=__consumer_offsets,Partition=17,Replica=3],[Topic=create.employee,Partition=0,Replica=3],[Topic=__consumer_offsets,Partition=47,Replica=3],[Topic=__consumer_offsets,Partition=38,Replica=3],[Topic=__consumer_offsets,Partition=8,Replica=3],[Topic=__consumer_offsets,Partition=29,Replica=3],[Topic=__consumer_offsets,Partition=23,Replica=3],[Topic=__consumer_offsets,Partition=32,Replica=3],[Topic=__consumer_offsets,Partition=26,Replica=3],[Topic=__consumer_offsets,Partition=41,Replica=3],[Topic=__consumer_offsets,Partition=11,Replica=3],[Topic=__consumer_offsets,Partition=20,Replica=3],[Topic=create.employee,Partition=1,Replica=3],[Topic=__consumer_offsets,Partition=14,Replica=3],[Topic=__consumer_offsets,Partition=2,Replica=3],[Topic=__consumer_offsets,Partition=44,Replica=3],[Topic=__consumer_offsets,Partition=5,Replica=3] (kafka.controller.ReplicaStateMachine)
[2019-02-05 07:48:56,898] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-35. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,899] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-35 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,902] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-35 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,902] DEBUG [Controller id=4] Removing replica 3 from ISR 4,0 for partition create.employee-2. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,903] WARN [Controller id=4] Cannot remove replica 3 from ISR of partition create.employee-2 since it is not in the ISR. Leader = 4 ; ISR = List(4, 0) (kafka.controller.KafkaController)
[2019-02-05 07:48:56,903] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-17. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,904] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-17 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,905] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-17 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,906] DEBUG [Controller id=4] Removing replica 3 from ISR 4,0 for partition create.employee-0. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,906] WARN [Controller id=4] Cannot remove replica 3 from ISR of partition create.employee-0 since it is not in the ISR. Leader = 4 ; ISR = List(4, 0) (kafka.controller.KafkaController)
[2019-02-05 07:48:56,907] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-47. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,907] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-47 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,909] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-47 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,909] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-38. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,910] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-38 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,911] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-38 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,911] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-8. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,913] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-8 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,914] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-8 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,914] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-29. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,915] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-29 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,916] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-29 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,916] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-23. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,917] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-23 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,918] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-23 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,919] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-32. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,920] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-32 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,921] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-32 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,921] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-26. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,922] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-26 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,923] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-26 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,923] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-41. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,925] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-41 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,926] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-41 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,927] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-11. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,928] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-11 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,929] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-11 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,930] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-20. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,931] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-20 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,932] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-20 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,932] DEBUG [Controller id=4] Removing replica 3 from ISR 4,0 for partition create.employee-1. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,933] WARN [Controller id=4] Cannot remove replica 3 from ISR of partition create.employee-1 since it is not in the ISR. Leader = 4 ; ISR = List(4, 0) (kafka.controller.KafkaController)
[2019-02-05 07:48:56,933] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-14. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,935] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-14 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,936] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-14 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,936] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-2. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,938] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-2 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,939] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-2 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,940] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-44. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,941] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-44 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,942] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-44 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,943] DEBUG [Controller id=4] Removing replica 3 from ISR 3 for partition __consumer_offsets-5. (kafka.controller.KafkaController)
[2019-02-05 07:48:56,944] INFO [Controller id=4] Retaining last ISR 3 of partition __consumer_offsets-5 since unclean leader election is disabled (kafka.controller.KafkaController)
[2019-02-05 07:48:56,945] INFO [Controller id=4] New leader and ISR for partition __consumer_offsets-5 is {"leader":-1,"leader_epoch":7,"isr":[3]} (kafka.controller.KafkaController)
[2019-02-05 07:48:56,947] DEBUG The stop replica request (delete = true) sent to broker 3 is  (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:56,948] DEBUG The stop replica request (delete = false) sent to broker 3 is [Topic=__consumer_offsets,Partition=35,Replica=3],[Topic=create.employee,Partition=2,Replica=3],[Topic=__consumer_offsets,Partition=17,Replica=3],[Topic=create.employee,Partition=0,Replica=3],[Topic=__consumer_offsets,Partition=47,Replica=3],[Topic=__consumer_offsets,Partition=38,Replica=3],[Topic=__consumer_offsets,Partition=8,Replica=3],[Topic=__consumer_offsets,Partition=29,Replica=3],[Topic=__consumer_offsets,Partition=23,Replica=3],[Topic=__consumer_offsets,Partition=32,Replica=3],[Topic=__consumer_offsets,Partition=26,Replica=3],[Topic=__consumer_offsets,Partition=41,Replica=3],[Topic=__consumer_offsets,Partition=11,Replica=3],[Topic=__consumer_offsets,Partition=20,Replica=3],[Topic=create.employee,Partition=1,Replica=3],[Topic=__consumer_offsets,Partition=14,Replica=3],[Topic=__consumer_offsets,Partition=2,Replica=3],[Topic=__consumer_offsets,Partition=44,Replica=3],[Topic=__consumer_offsets,Partition=5,Replica=3] (kafka.controller.ControllerBrokerRequestBatch)
[2019-02-05 07:48:56,948] WARN [Channel manager on controller 4]: Not sending request (type=StopReplicaRequest, controllerId=4, controllerEpoch=4, deletePartitions=false, partitions=__consumer_offsets-8,__consumer_offsets-35,__consumer_offsets-41,__consumer_offsets-23,__consumer_offsets-47,__consumer_offsets-38,__consumer_offsets-17,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-14,create.employee-0,create.employee-2,__consumer_offsets-20,__consumer_offsets-44,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,create.employee-1,__consumer_offsets-32) to broker 3, since it is offline. (kafka.controller.ControllerChannelManager)
[2019-02-05 07:50:11,743] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-02-05 07:50:11,744] DEBUG [Controller id=4] Preferred replicas by broker Map(4 -> Map(__consumer_offsets-30 -> Vector(4), __consumer_offsets-39 -> Vector(4), testtopic-0 -> Vector(4), __consumer_offsets-18 -> Vector(4), __consumer_offsets-0 -> Vector(4), __consumer_offsets-24 -> Vector(4), __consumer_offsets-33 -> Vector(4), __consumer_offsets-3 -> Vector(4), __consumer_offsets-21 -> Vector(4), __consumer_offsets-12 -> Vector(4), __consumer_offsets-15 -> Vector(4), __consumer_offsets-48 -> Vector(4), __consumer_offsets-6 -> Vector(4), __consumer_offsets-42 -> Vector(4), __consumer_offsets-27 -> Vector(4), __consumer_offsets-45 -> Vector(4), __consumer_offsets-36 -> Vector(4), create.employee-0 -> Vector(4, 0, 3), __consumer_offsets-9 -> Vector(4), create.assignment-0 -> Vector(4)), 3 -> Map(__consumer_offsets-47 -> Vector(3), __consumer_offsets-29 -> Vector(3), __consumer_offsets-41 -> Vector(3), __consumer_offsets-17 -> Vector(3), create.employee-2 -> Vector(3, 4, 0), __consumer_offsets-14 -> Vector(3), __consumer_offsets-26 -> Vector(3), __consumer_offsets-20 -> Vector(3), __consumer_offsets-5 -> Vector(3), __consumer_offsets-8 -> Vector(3), __consumer_offsets-23 -> Vector(3), __consumer_offsets-11 -> Vector(3), __consumer_offsets-44 -> Vector(3), __consumer_offsets-32 -> Vector(3), __consumer_offsets-35 -> Vector(3), __consumer_offsets-38 -> Vector(3), __consumer_offsets-2 -> Vector(3)), 0 -> Map(__consumer_offsets-19 -> Vector(0), __consumer_offsets-10 -> Vector(0), __consumer_offsets-40 -> Vector(0), __consumer_offsets-22 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-28 -> Vector(0), __consumer_offsets-4 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-34 -> Vector(0), __consumer_offsets-46 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-1 -> Vector(0), create.employee-1 -> Vector(0, 3, 4), __consumer_offsets-16 -> Vector(0))) (kafka.controller.KafkaController)
[2019-02-05 07:50:11,744] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2019-02-05 07:50:11,744] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2019-02-05 07:50:11,744] DEBUG [Controller id=4] Topics not in preferred replica Map(__consumer_offsets-47 -> Vector(3), __consumer_offsets-29 -> Vector(3), __consumer_offsets-41 -> Vector(3), __consumer_offsets-17 -> Vector(3), create.employee-2 -> Vector(3, 4, 0), __consumer_offsets-14 -> Vector(3), __consumer_offsets-26 -> Vector(3), __consumer_offsets-20 -> Vector(3), __consumer_offsets-5 -> Vector(3), __consumer_offsets-8 -> Vector(3), __consumer_offsets-23 -> Vector(3), __consumer_offsets-11 -> Vector(3), __consumer_offsets-44 -> Vector(3), __consumer_offsets-32 -> Vector(3), __consumer_offsets-35 -> Vector(3), __consumer_offsets-38 -> Vector(3), __consumer_offsets-2 -> Vector(3)) (kafka.controller.KafkaController)
[2019-02-05 07:50:11,744] TRACE [Controller id=4] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2019-02-05 07:50:11,744] DEBUG [Controller id=4] Topics not in preferred replica Map(create.employee-1 -> Vector(0, 3, 4)) (kafka.controller.KafkaController)
[2019-02-05 07:50:11,744] TRACE [Controller id=4] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
[2019-02-05 07:55:11,752] TRACE [Controller id=4] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-02-05 07:55:11,752] DEBUG [Controller id=4] Preferred replicas by broker Map(4 -> Map(__consumer_offsets-30 -> Vector(4), __consumer_offsets-39 -> Vector(4), testtopic-0 -> Vector(4), __consumer_offsets-18 -> Vector(4), __consumer_offsets-0 -> Vector(4), __consumer_offsets-24 -> Vector(4), __consumer_offsets-33 -> Vector(4), __consumer_offsets-3 -> Vector(4), __consumer_offsets-21 -> Vector(4), __consumer_offsets-12 -> Vector(4), __consumer_offsets-15 -> Vector(4), __consumer_offsets-48 -> Vector(4), __consumer_offsets-6 -> Vector(4), __consumer_offsets-42 -> Vector(4), __consumer_offsets-27 -> Vector(4), __consumer_offsets-45 -> Vector(4), __consumer_offsets-36 -> Vector(4), create.employee-0 -> Vector(4, 0, 3), __consumer_offsets-9 -> Vector(4), create.assignment-0 -> Vector(4)), 3 -> Map(__consumer_offsets-47 -> Vector(3), __consumer_offsets-29 -> Vector(3), __consumer_offsets-41 -> Vector(3), __consumer_offsets-17 -> Vector(3), create.employee-2 -> Vector(3, 4, 0), __consumer_offsets-14 -> Vector(3), __consumer_offsets-26 -> Vector(3), __consumer_offsets-20 -> Vector(3), __consumer_offsets-5 -> Vector(3), __consumer_offsets-8 -> Vector(3), __consumer_offsets-23 -> Vector(3), __consumer_offsets-11 -> Vector(3), __consumer_offsets-44 -> Vector(3), __consumer_offsets-32 -> Vector(3), __consumer_offsets-35 -> Vector(3), __consumer_offsets-38 -> Vector(3), __consumer_offsets-2 -> Vector(3)), 0 -> Map(__consumer_offsets-19 -> Vector(0), __consumer_offsets-10 -> Vector(0), __consumer_offsets-40 -> Vector(0), __consumer_offsets-22 -> Vector(0), __consumer_offsets-13 -> Vector(0), __consumer_offsets-49 -> Vector(0), __consumer_offsets-28 -> Vector(0), __consumer_offsets-4 -> Vector(0), __consumer_offsets-37 -> Vector(0), __consumer_offsets-31 -> Vector(0), __consumer_offsets-34 -> Vector(0), __consumer_offsets-46 -> Vector(0), __consumer_offsets-25 -> Vector(0), __consumer_offsets-43 -> Vector(0), __consumer_offsets-7 -> Vector(0), __consumer_offsets-1 -> Vector(0), create.employee-1 -> Vector(0, 3, 4), __consumer_offsets-16 -> Vector(0))) (kafka.controller.KafkaController)
[2019-02-05 07:55:11,752] DEBUG [Controller id=4] Topics not in preferred replica Map() (kafka.controller.KafkaController)
[2019-02-05 07:55:11,752] TRACE [Controller id=4] Leader imbalance ratio for broker 4 is 0.0 (kafka.controller.KafkaController)
[2019-02-05 07:55:11,753] DEBUG [Controller id=4] Topics not in preferred replica Map(__consumer_offsets-47 -> Vector(3), __consumer_offsets-29 -> Vector(3), __consumer_offsets-41 -> Vector(3), __consumer_offsets-17 -> Vector(3), create.employee-2 -> Vector(3, 4, 0), __consumer_offsets-14 -> Vector(3), __consumer_offsets-26 -> Vector(3), __consumer_offsets-20 -> Vector(3), __consumer_offsets-5 -> Vector(3), __consumer_offsets-8 -> Vector(3), __consumer_offsets-23 -> Vector(3), __consumer_offsets-11 -> Vector(3), __consumer_offsets-44 -> Vector(3), __consumer_offsets-32 -> Vector(3), __consumer_offsets-35 -> Vector(3), __consumer_offsets-38 -> Vector(3), __consumer_offsets-2 -> Vector(3)) (kafka.controller.KafkaController)
[2019-02-05 07:55:11,753] TRACE [Controller id=4] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2019-02-05 07:55:11,753] DEBUG [Controller id=4] Topics not in preferred replica Map(create.employee-1 -> Vector(0, 3, 4)) (kafka.controller.KafkaController)
[2019-02-05 07:55:11,753] TRACE [Controller id=4] Leader imbalance ratio for broker 0 is 0.05555555555555555 (kafka.controller.KafkaController)
