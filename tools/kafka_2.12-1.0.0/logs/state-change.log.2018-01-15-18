[2018-01-15 19:03:51,391] TRACE [Broker id=0] Handling stop replica (delete=false) for partition my_topic-2 (state.change.logger)
[2018-01-15 19:03:51,393] TRACE [Broker id=0] Finished handling stop replica (delete=false) for partition my_topic-2 (state.change.logger)
[2018-01-15 19:03:51,394] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partitions=[{topic=my_topic,partition=2,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2018-01-15 19:03:51,399] TRACE [Controller id=0 epoch=1] Changed state of replica 0 for partition my_topic-2 from OnlineReplica to OfflineReplica (state.change.logger)
[2018-01-15 19:03:51,408] TRACE [Controller id=0 epoch=1] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=1, leader=4, leaderEpoch=1, isr=4,3, zkVersion=1, replicas=4,3,0, isNew=false) to broker 4 for partition my_topic-2 (state.change.logger)
[2018-01-15 19:03:51,411] TRACE [Controller id=0 epoch=1] Sending become-follower LeaderAndIsr request PartitionState(controllerEpoch=1, leader=4, leaderEpoch=1, isr=4,3, zkVersion=1, replicas=4,3,0, isNew=false) to broker 3 for partition my_topic-2 (state.change.logger)
[2018-01-15 19:03:51,412] TRACE [Controller id=0 epoch=1] Sending UpdateMetadata request PartitionState(controllerEpoch=1, leader=4, leaderEpoch=1, isr=[4, 3], zkVersion=1, replicas=[4, 3, 0], offlineReplicas=[0]) to brokers Set(0, 3, 4) for partition my_topic-2 (state.change.logger)
[2018-01-15 19:03:51,413] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=1, leader=4, leaderEpoch=1, isr=[4, 3], zkVersion=1, replicas=[4, 3, 0], offlineReplicas=[0]) for partition my_topic-2 in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 8 (state.change.logger)
[2018-01-15 19:03:51,414] TRACE [Controller id=0 epoch=1] Received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2018-01-15 19:03:51,417] TRACE [Controller id=0 epoch=1] Changed state of replica 0 for partition my_topic-1 from OnlineReplica to OfflineReplica (state.change.logger)
[2018-01-15 19:03:51,417] TRACE [Controller id=0 epoch=1] Sending become-follower LeaderAndIsr request PartitionState(controllerEpoch=1, leader=3, leaderEpoch=1, isr=3,4, zkVersion=1, replicas=3,0,4, isNew=false) to broker 4 for partition my_topic-1 (state.change.logger)
[2018-01-15 19:03:51,417] TRACE [Controller id=0 epoch=1] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=1, leader=3, leaderEpoch=1, isr=3,4, zkVersion=1, replicas=3,0,4, isNew=false) to broker 3 for partition my_topic-1 (state.change.logger)
[2018-01-15 19:03:51,417] TRACE [Controller id=0 epoch=1] Sending UpdateMetadata request PartitionState(controllerEpoch=1, leader=3, leaderEpoch=1, isr=[3, 4], zkVersion=1, replicas=[3, 0, 4], offlineReplicas=[0]) to brokers Set(0, 3, 4) for partition my_topic-1 (state.change.logger)
[2018-01-15 19:03:51,418] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partitions=[{topic=my_topic,partition=2,error_code=0}]} for a request sent to broker localhost:9093 (id: 3 rack: null) (state.change.logger)
[2018-01-15 19:03:51,419] TRACE [Controller id=0 epoch=1] Received response {error_code=0} for a request sent to broker localhost:9093 (id: 3 rack: null) (state.change.logger)
[2018-01-15 19:03:51,419] TRACE [Controller id=0 epoch=1] Started leader election for partition my_topic-0 (state.change.logger)
[2018-01-15 19:03:51,420] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partitions=[{topic=my_topic,partition=2,error_code=0}]} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-15 19:03:51,421] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partitions=[{topic=my_topic,partition=1,error_code=0}]} for a request sent to broker localhost:9093 (id: 3 rack: null) (state.change.logger)
[2018-01-15 19:03:51,421] TRACE [Controller id=0 epoch=1] Received response {error_code=0} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-15 19:03:51,424] TRACE [Controller id=0 epoch=1] Received response {error_code=0} for a request sent to broker localhost:9093 (id: 3 rack: null) (state.change.logger)
[2018-01-15 19:03:51,427] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partitions=[{topic=my_topic,partition=1,error_code=0}]} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-15 19:03:51,427] TRACE [Controller id=0 epoch=1] Elected leader 4 for Offline partition my_topic-0 (state.change.logger)
[2018-01-15 19:03:51,428] TRACE [Controller id=0 epoch=1] Received response {error_code=0} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-15 19:03:51,428] TRACE [Controller id=0 epoch=1] Changed partition my_topic-0 from OnlinePartition to OnlinePartition with leader 4 (state.change.logger)
[2018-01-15 19:03:51,429] TRACE [Controller id=0 epoch=1] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=1, leader=4, leaderEpoch=1, isr=4,3, zkVersion=1, replicas=0,4,3, isNew=false) to broker 4 for partition my_topic-0 (state.change.logger)
[2018-01-15 19:03:51,429] TRACE [Controller id=0 epoch=1] Sending become-follower LeaderAndIsr request PartitionState(controllerEpoch=1, leader=4, leaderEpoch=1, isr=4,3, zkVersion=1, replicas=0,4,3, isNew=false) to broker 3 for partition my_topic-0 (state.change.logger)
[2018-01-15 19:03:51,429] TRACE [Controller id=0 epoch=1] Sending become-follower LeaderAndIsr request PartitionState(controllerEpoch=1, leader=4, leaderEpoch=1, isr=4,3, zkVersion=1, replicas=0,4,3, isNew=false) to broker 0 for partition my_topic-0 (state.change.logger)
[2018-01-15 19:03:51,429] TRACE [Controller id=0 epoch=1] Sending UpdateMetadata request PartitionState(controllerEpoch=1, leader=4, leaderEpoch=1, isr=[4, 3], zkVersion=1, replicas=[0, 4, 3], offlineReplicas=[0]) to brokers Set(0, 3, 4) for partition my_topic-0 (state.change.logger)
[2018-01-15 19:03:51,464] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partitions=[{topic=my_topic,partition=0,error_code=0}]} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-15 19:03:51,466] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partitions=[{topic=my_topic,partition=0,error_code=0}]} for a request sent to broker localhost:9093 (id: 3 rack: null) (state.change.logger)
[2018-01-15 19:03:51,466] TRACE [Controller id=0 epoch=1] Received response {error_code=0} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-15 19:03:51,467] TRACE [Controller id=0 epoch=1] Received response {error_code=0} for a request sent to broker localhost:9093 (id: 3 rack: null) (state.change.logger)
[2018-01-15 19:03:51,755] TRACE [Broker id=0] Handling stop replica (delete=false) for partition my_topic-2 (state.change.logger)
[2018-01-15 19:03:51,755] TRACE [Broker id=0] Finished handling stop replica (delete=false) for partition my_topic-2 (state.change.logger)
[2018-01-15 19:03:53,200] TRACE [Controller id=0 epoch=1] Sending UpdateMetadata request PartitionState(controllerEpoch=1, leader=3, leaderEpoch=1, isr=[3, 4, 0], zkVersion=2, replicas=[3, 0, 4], offlineReplicas=[0]) to brokers Set(0, 3, 4) for partition my_topic-1 (state.change.logger)
[2018-01-15 19:03:53,201] TRACE [Controller id=0 epoch=1] Received response {error_code=0} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-15 19:03:53,201] TRACE [Controller id=0 epoch=1] Received response {error_code=0} for a request sent to broker localhost:9093 (id: 3 rack: null) (state.change.logger)
