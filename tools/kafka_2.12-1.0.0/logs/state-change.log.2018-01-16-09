[2018-01-16 12:41:48,939] TRACE [Controller id=3 epoch=10] Started leader election for partition my_topic-2 (state.change.logger)
[2018-01-16 12:41:48,972] TRACE [Controller id=3 epoch=10] Elected leader 4 for Offline partition my_topic-2 (state.change.logger)
[2018-01-16 12:41:48,972] TRACE [Controller id=3 epoch=10] Changed partition my_topic-2 from OnlinePartition to OnlinePartition with leader 4 (state.change.logger)
[2018-01-16 12:41:48,972] TRACE [Controller id=3 epoch=10] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=4, zkVersion=19, replicas=4,3,0, isNew=false) to broker 4 for partition my_topic-2 (state.change.logger)
[2018-01-16 12:41:48,972] TRACE [Controller id=3 epoch=10] Sending become-follower LeaderAndIsr request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=4, zkVersion=19, replicas=4,3,0, isNew=false) to broker 3 for partition my_topic-2 (state.change.logger)
[2018-01-16 12:41:48,972] TRACE [Controller id=3 epoch=10] Sending UpdateMetadata request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=[4], zkVersion=19, replicas=[4, 3, 0], offlineReplicas=[3, 0]) to brokers Set(3, 4) for partition my_topic-2 (state.change.logger)
[2018-01-16 12:41:48,973] TRACE [Controller id=3 epoch=10] Started leader election for partition my_topic-1 (state.change.logger)
[2018-01-16 12:41:48,974] TRACE [Broker id=3] Received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=4, zkVersion=19, replicas=4,3,0, isNew=false) correlation id 16 from controller 3 epoch 10 for partition my_topic-2 (state.change.logger)
[2018-01-16 12:41:48,975] TRACE [Controller id=3 epoch=10] Elected leader 4 for Offline partition my_topic-1 (state.change.logger)
[2018-01-16 12:41:48,975] TRACE [Controller id=3 epoch=10] Changed partition my_topic-1 from OnlinePartition to OnlinePartition with leader 4 (state.change.logger)
[2018-01-16 12:41:48,975] TRACE [Controller id=3 epoch=10] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=4, zkVersion=20, replicas=3,0,4, isNew=false) to broker 4 for partition my_topic-1 (state.change.logger)
[2018-01-16 12:41:48,975] TRACE [Controller id=3 epoch=10] Sending become-follower LeaderAndIsr request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=4, zkVersion=20, replicas=3,0,4, isNew=false) to broker 3 for partition my_topic-1 (state.change.logger)
[2018-01-16 12:41:48,975] TRACE [Controller id=3 epoch=10] Sending UpdateMetadata request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=[4], zkVersion=20, replicas=[3, 0, 4], offlineReplicas=[3, 0]) to brokers Set(3, 4) for partition my_topic-1 (state.change.logger)
[2018-01-16 12:41:48,975] TRACE [Controller id=3 epoch=10] Started leader election for partition my_topic-0 (state.change.logger)
[2018-01-16 12:41:48,976] TRACE [Broker id=3] Handling LeaderAndIsr request correlationId 16 from controller 3 epoch 10 starting the become-follower transition for partition my_topic-2 (state.change.logger)
[2018-01-16 12:41:48,977] TRACE [Controller id=3 epoch=10] Elected leader 4 for Offline partition my_topic-0 (state.change.logger)
[2018-01-16 12:41:48,978] TRACE [Controller id=3 epoch=10] Changed partition my_topic-0 from OnlinePartition to OnlinePartition with leader 4 (state.change.logger)
[2018-01-16 12:41:48,978] TRACE [Controller id=3 epoch=10] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=4, zkVersion=19, replicas=0,4,3, isNew=false) to broker 4 for partition my_topic-0 (state.change.logger)
[2018-01-16 12:41:48,978] TRACE [Controller id=3 epoch=10] Sending become-follower LeaderAndIsr request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=4, zkVersion=19, replicas=0,4,3, isNew=false) to broker 3 for partition my_topic-0 (state.change.logger)
[2018-01-16 12:41:48,978] TRACE [Controller id=3 epoch=10] Sending UpdateMetadata request PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=[4], zkVersion=19, replicas=[0, 4, 3], offlineReplicas=[0, 3]) to brokers Set(3, 4) for partition my_topic-0 (state.change.logger)
[2018-01-16 12:41:48,980] TRACE [Controller id=3 epoch=10] Received response {error_code=0,partitions=[{topic=my_topic,partition=2,error_code=0}]} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-16 12:41:48,981] TRACE [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 10 with correlation id 16 for partition my_topic-2 (state.change.logger)
[2018-01-16 12:41:48,982] TRACE [Broker id=3] Truncated logs and checkpointed recovery boundaries for partition my_topic-2 as part of become-follower request with correlation id 16 from controller 3 epoch 10 (state.change.logger)
[2018-01-16 12:41:48,983] TRACE [Broker id=3] Skipped the adding-fetcher step of the become-follower state change with correlation id 16 from controller 3 epoch 10 for partition my_topic-2 since it is shutting down (state.change.logger)
[2018-01-16 12:41:48,983] TRACE [Broker id=3] Completed LeaderAndIsr request correlationId 16 from controller 3 epoch 10 for the become-follower transition for partition my_topic-2 (state.change.logger)
[2018-01-16 12:41:48,983] TRACE [Controller id=3 epoch=10] Received response {error_code=0} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-16 12:41:48,984] TRACE [Controller id=3 epoch=10] Received response {error_code=0,partitions=[{topic=my_topic,partition=2,error_code=0}]} for a request sent to broker localhost:9093 (id: 3 rack: null) (state.change.logger)
[2018-01-16 12:41:48,984] TRACE [Broker id=3] Cached leader info PartitionState(controllerEpoch=10, leader=4, leaderEpoch=9, isr=[4], zkVersion=19, replicas=[4, 3, 0], offlineReplicas=[3, 0]) for partition my_topic-2 in response to UpdateMetadata request sent by controller 3 epoch 10 with correlation id 17 (state.change.logger)
[2018-01-16 12:41:48,985] TRACE [Controller id=3 epoch=10] Received response {error_code=0,partitions=[{topic=my_topic,partition=1,error_code=0}]} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-16 12:41:48,986] TRACE [Controller id=3 epoch=10] Received response {error_code=0} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-16 12:41:48,993] TRACE [Controller id=3 epoch=10] Received response {error_code=0,partitions=[{topic=my_topic,partition=0,error_code=0}]} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
[2018-01-16 12:41:48,994] TRACE [Controller id=3 epoch=10] Received response {error_code=0} for a request sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
